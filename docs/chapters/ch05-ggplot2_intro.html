<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Introduction to Data Visualization with ggplot2 – Introduction to Data Science &amp; Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/ch06-ggplot2_advanced.html" rel="next">
<link href="../chapters/ch04-dplyr.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-1aba93c23277590c02f57900b721ea1a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">


</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/ch01-foundations.html">Part 1: Introduction to Data Science</a></li><li class="breadcrumb-item"><a href="../chapters/ch05-ggplot2_intro.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to Data Visualization with ggplot2</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Introduction to Data Science &amp; Statistics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 1: Introduction to Data Science</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch01-foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Foundations of Data Science &amp; Best Practices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch02-r_rstudio_reading_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started with R, RStudio, and Reading Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch03-data_types_strings_dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Types, Strings, and Introduction to dplyr</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch04-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Manipulation with dplyr</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch05-ggplot2_intro.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to Data Visualization with ggplot2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch06-ggplot2_advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Advanced ggplot2 and Multi-Panel Plots</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch07-tidyr_joins_purrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Reshaping, Joining, and Iteration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch08-special_formats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Special Data Formats, Integration, and Course Wrap-up</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 2: Introduction to Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch09-statistical_foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Week 9: Statistical Foundations and Study Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch10-descriptive_statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Week 10: Descriptive Statistics and Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch11-probability_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Week 11: Probability Distributions and Introduction to Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch12-hypothesis_testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Week 12: Hypothesis Testing Fundamentals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch13-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Week 13: Analysis of Variance (ANOVA)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch14-categorical_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Week 14: Categorical Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch15-linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Week 15: Simple Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch16-multiple_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Week 16: Multiple Regression &amp; Course Integration</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives"><span class="header-section-number">5.1</span> Learning Objectives</a></li>
  <li><a href="#introduction-to-the-grammar-of-graphics" id="toc-introduction-to-the-grammar-of-graphics" class="nav-link" data-scroll-target="#introduction-to-the-grammar-of-graphics"><span class="header-section-number">5.2</span> Introduction to the Grammar of Graphics</a>
  <ul class="collapse">
  <li><a href="#what-is-ggplot2" id="toc-what-is-ggplot2" class="nav-link" data-scroll-target="#what-is-ggplot2"><span class="header-section-number">5.2.1</span> What is ggplot2?</a></li>
  <li><a href="#the-grammar-of-graphics-philosophy" id="toc-the-grammar-of-graphics-philosophy" class="nav-link" data-scroll-target="#the-grammar-of-graphics-philosophy"><span class="header-section-number">5.2.2</span> The Grammar of Graphics Philosophy</a></li>
  <li><a href="#the-three-essential-components" id="toc-the-three-essential-components" class="nav-link" data-scroll-target="#the-three-essential-components"><span class="header-section-number">5.2.3</span> The Three Essential Components</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup"><span class="header-section-number">5.2.4</span> Setup</a></li>
  </ul></li>
  <li><a href="#your-first-ggplot-scatter-plots-with-geom_point" id="toc-your-first-ggplot-scatter-plots-with-geom_point" class="nav-link" data-scroll-target="#your-first-ggplot-scatter-plots-with-geom_point"><span class="header-section-number">5.3</span> Your First ggplot: Scatter Plots with <code>geom_point()</code></a>
  <ul class="collapse">
  <li><a href="#basic-scatter-plot" id="toc-basic-scatter-plot" class="nav-link" data-scroll-target="#basic-scatter-plot"><span class="header-section-number">5.3.1</span> Basic Scatter Plot</a></li>
  <li><a href="#adding-color-by-group" id="toc-adding-color-by-group" class="nav-link" data-scroll-target="#adding-color-by-group"><span class="header-section-number">5.3.2</span> Adding Color by Group</a></li>
  <li><a href="#customizing-point-aesthetics" id="toc-customizing-point-aesthetics" class="nav-link" data-scroll-target="#customizing-point-aesthetics"><span class="header-section-number">5.3.3</span> Customizing Point Aesthetics</a></li>
  <li><a href="#when-to-use-scatter-plots" id="toc-when-to-use-scatter-plots" class="nav-link" data-scroll-target="#when-to-use-scatter-plots"><span class="header-section-number">5.3.4</span> When to Use Scatter Plots</a></li>
  </ul></li>
  <li><a href="#line-plots-with-geom_line" id="toc-line-plots-with-geom_line" class="nav-link" data-scroll-target="#line-plots-with-geom_line"><span class="header-section-number">5.4</span> Line Plots with <code>geom_line()</code></a>
  <ul class="collapse">
  <li><a href="#example-growth-curves" id="toc-example-growth-curves" class="nav-link" data-scroll-target="#example-growth-curves"><span class="header-section-number">5.4.1</span> Example: Growth Curves</a></li>
  <li><a href="#combining-lines-and-points" id="toc-combining-lines-and-points" class="nav-link" data-scroll-target="#combining-lines-and-points"><span class="header-section-number">5.4.2</span> Combining Lines and Points</a></li>
  <li><a href="#customizing-lines" id="toc-customizing-lines" class="nav-link" data-scroll-target="#customizing-lines"><span class="header-section-number">5.4.3</span> Customizing Lines</a></li>
  <li><a href="#when-to-use-line-plots" id="toc-when-to-use-line-plots" class="nav-link" data-scroll-target="#when-to-use-line-plots"><span class="header-section-number">5.4.4</span> When to Use Line Plots</a></li>
  </ul></li>
  <li><a href="#bar-charts-with-geom_col-and-geom_bar" id="toc-bar-charts-with-geom_col-and-geom_bar" class="nav-link" data-scroll-target="#bar-charts-with-geom_col-and-geom_bar"><span class="header-section-number">5.5</span> Bar Charts with <code>geom_col()</code> and <code>geom_bar()</code></a>
  <ul class="collapse">
  <li><a href="#geom_col-vs-geom_bar" id="toc-geom_col-vs-geom_bar" class="nav-link" data-scroll-target="#geom_col-vs-geom_bar"><span class="header-section-number">5.5.1</span> <code>geom_col()</code> vs <code>geom_bar()</code></a></li>
  <li><a href="#using-geom_col-with-pre-calculated-values" id="toc-using-geom_col-with-pre-calculated-values" class="nav-link" data-scroll-target="#using-geom_col-with-pre-calculated-values"><span class="header-section-number">5.5.2</span> Using <code>geom_col()</code> with Pre-calculated Values</a></li>
  <li><a href="#using-geom_bar-to-count" id="toc-using-geom_bar-to-count" class="nav-link" data-scroll-target="#using-geom_bar-to-count"><span class="header-section-number">5.5.3</span> Using <code>geom_bar()</code> to Count</a></li>
  <li><a href="#adding-color" id="toc-adding-color" class="nav-link" data-scroll-target="#adding-color"><span class="header-section-number">5.5.4</span> Adding Color</a></li>
  <li><a href="#grouped-and-stacked-bars" id="toc-grouped-and-stacked-bars" class="nav-link" data-scroll-target="#grouped-and-stacked-bars"><span class="header-section-number">5.5.5</span> Grouped and Stacked Bars</a></li>
  <li><a href="#horizontal-bars" id="toc-horizontal-bars" class="nav-link" data-scroll-target="#horizontal-bars"><span class="header-section-number">5.5.6</span> Horizontal Bars</a></li>
  <li><a href="#when-to-use-bar-charts" id="toc-when-to-use-bar-charts" class="nav-link" data-scroll-target="#when-to-use-bar-charts"><span class="header-section-number">5.5.7</span> When to Use Bar Charts</a></li>
  </ul></li>
  <li><a href="#histograms-with-geom_histogram" id="toc-histograms-with-geom_histogram" class="nav-link" data-scroll-target="#histograms-with-geom_histogram"><span class="header-section-number">5.6</span> Histograms with <code>geom_histogram()</code></a>
  <ul class="collapse">
  <li><a href="#basic-histogram" id="toc-basic-histogram" class="nav-link" data-scroll-target="#basic-histogram"><span class="header-section-number">5.6.1</span> Basic Histogram</a></li>
  <li><a href="#customizing-binwidth" id="toc-customizing-binwidth" class="nav-link" data-scroll-target="#customizing-binwidth"><span class="header-section-number">5.6.2</span> Customizing Binwidth</a></li>
  <li><a href="#overlapping-histograms-by-group" id="toc-overlapping-histograms-by-group" class="nav-link" data-scroll-target="#overlapping-histograms-by-group"><span class="header-section-number">5.6.3</span> Overlapping Histograms by Group</a></li>
  <li><a href="#when-to-use-histograms" id="toc-when-to-use-histograms" class="nav-link" data-scroll-target="#when-to-use-histograms"><span class="header-section-number">5.6.4</span> When to Use Histograms</a></li>
  </ul></li>
  <li><a href="#box-plots-with-geom_boxplot" id="toc-box-plots-with-geom_boxplot" class="nav-link" data-scroll-target="#box-plots-with-geom_boxplot"><span class="header-section-number">5.7</span> Box Plots with <code>geom_boxplot()</code></a>
  <ul class="collapse">
  <li><a href="#anatomy-of-a-box-plot" id="toc-anatomy-of-a-box-plot" class="nav-link" data-scroll-target="#anatomy-of-a-box-plot"><span class="header-section-number">5.7.1</span> Anatomy of a Box Plot</a></li>
  <li><a href="#basic-box-plot" id="toc-basic-box-plot" class="nav-link" data-scroll-target="#basic-box-plot"><span class="header-section-number">5.7.2</span> Basic Box Plot</a></li>
  <li><a href="#adding-color-1" id="toc-adding-color-1" class="nav-link" data-scroll-target="#adding-color-1"><span class="header-section-number">5.7.3</span> Adding Color</a></li>
  <li><a href="#combining-box-plots-with-individual-points" id="toc-combining-box-plots-with-individual-points" class="nav-link" data-scroll-target="#combining-box-plots-with-individual-points"><span class="header-section-number">5.7.4</span> Combining Box Plots with Individual Points</a></li>
  <li><a href="#when-to-use-box-plots" id="toc-when-to-use-box-plots" class="nav-link" data-scroll-target="#when-to-use-box-plots"><span class="header-section-number">5.7.5</span> When to Use Box Plots</a></li>
  </ul></li>
  <li><a href="#violin-plots-with-geom_violin" id="toc-violin-plots-with-geom_violin" class="nav-link" data-scroll-target="#violin-plots-with-geom_violin"><span class="header-section-number">5.8</span> Violin Plots with <code>geom_violin()</code></a>
  <ul class="collapse">
  <li><a href="#basic-violin-plot" id="toc-basic-violin-plot" class="nav-link" data-scroll-target="#basic-violin-plot"><span class="header-section-number">5.8.1</span> Basic Violin Plot</a></li>
  <li><a href="#combining-violin-plots-with-box-plots" id="toc-combining-violin-plots-with-box-plots" class="nav-link" data-scroll-target="#combining-violin-plots-with-box-plots"><span class="header-section-number">5.8.2</span> Combining Violin Plots with Box Plots</a></li>
  <li><a href="#adding-points" id="toc-adding-points" class="nav-link" data-scroll-target="#adding-points"><span class="header-section-number">5.8.3</span> Adding Points</a></li>
  <li><a href="#when-to-use-violin-plots" id="toc-when-to-use-violin-plots" class="nav-link" data-scroll-target="#when-to-use-violin-plots"><span class="header-section-number">5.8.4</span> When to Use Violin Plots</a></li>
  </ul></li>
  <li><a href="#aesthetic-mappings-a-deeper-dive" id="toc-aesthetic-mappings-a-deeper-dive" class="nav-link" data-scroll-target="#aesthetic-mappings-a-deeper-dive"><span class="header-section-number">5.9</span> Aesthetic Mappings: A Deeper Dive</a>
  <ul class="collapse">
  <li><a href="#common-aesthetics" id="toc-common-aesthetics" class="nav-link" data-scroll-target="#common-aesthetics"><span class="header-section-number">5.9.1</span> Common Aesthetics</a></li>
  <li><a href="#continuous-vs-discrete-variables" id="toc-continuous-vs-discrete-variables" class="nav-link" data-scroll-target="#continuous-vs-discrete-variables"><span class="header-section-number">5.9.2</span> Continuous vs Discrete Variables</a></li>
  </ul></li>
  <li><a href="#working-with-scales" id="toc-working-with-scales" class="nav-link" data-scroll-target="#working-with-scales"><span class="header-section-number">5.10</span> Working with Scales</a>
  <ul class="collapse">
  <li><a href="#scale-functions" id="toc-scale-functions" class="nav-link" data-scroll-target="#scale-functions"><span class="header-section-number">5.10.1</span> Scale Functions</a></li>
  <li><a href="#modifying-continuous-scales" id="toc-modifying-continuous-scales" class="nav-link" data-scroll-target="#modifying-continuous-scales"><span class="header-section-number">5.10.2</span> Modifying Continuous Scales</a></li>
  <li><a href="#log-transformations" id="toc-log-transformations" class="nav-link" data-scroll-target="#log-transformations"><span class="header-section-number">5.10.3</span> Log Transformations</a></li>
  <li><a href="#discrete-scales-manual-colors" id="toc-discrete-scales-manual-colors" class="nav-link" data-scroll-target="#discrete-scales-manual-colors"><span class="header-section-number">5.10.4</span> Discrete Scales: Manual Colors</a></li>
  <li><a href="#using-colorbrewer-palettes" id="toc-using-colorbrewer-palettes" class="nav-link" data-scroll-target="#using-colorbrewer-palettes"><span class="header-section-number">5.10.5</span> Using ColorBrewer Palettes</a></li>
  </ul></li>
  <li><a href="#labels-and-titles-with-labs" id="toc-labels-and-titles-with-labs" class="nav-link" data-scroll-target="#labels-and-titles-with-labs"><span class="header-section-number">5.11</span> Labels and Titles with <code>labs()</code></a></li>
  <li><a href="#themes-customizing-plot-appearance" id="toc-themes-customizing-plot-appearance" class="nav-link" data-scroll-target="#themes-customizing-plot-appearance"><span class="header-section-number">5.12</span> Themes: Customizing Plot Appearance</a>
  <ul class="collapse">
  <li><a href="#built-in-themes" id="toc-built-in-themes" class="nav-link" data-scroll-target="#built-in-themes"><span class="header-section-number">5.12.1</span> Built-in Themes</a></li>
  <li><a href="#setting-a-default-theme" id="toc-setting-a-default-theme" class="nav-link" data-scroll-target="#setting-a-default-theme"><span class="header-section-number">5.12.2</span> Setting a Default Theme</a></li>
  <li><a href="#customizing-themes" id="toc-customizing-themes" class="nav-link" data-scroll-target="#customizing-themes"><span class="header-section-number">5.12.3</span> Customizing Themes</a></li>
  </ul></li>
  <li><a href="#coordinate-systems" id="toc-coordinate-systems" class="nav-link" data-scroll-target="#coordinate-systems"><span class="header-section-number">5.13</span> Coordinate Systems</a>
  <ul class="collapse">
  <li><a href="#coord_cartesian-zooming" id="toc-coord_cartesian-zooming" class="nav-link" data-scroll-target="#coord_cartesian-zooming"><span class="header-section-number">5.13.1</span> <code>coord_cartesian()</code>: Zooming</a></li>
  <li><a href="#coord_flip-horizontal-plots" id="toc-coord_flip-horizontal-plots" class="nav-link" data-scroll-target="#coord_flip-horizontal-plots"><span class="header-section-number">5.13.2</span> <code>coord_flip()</code>: Horizontal Plots</a></li>
  <li><a href="#fixed-aspect-ratio" id="toc-fixed-aspect-ratio" class="nav-link" data-scroll-target="#fixed-aspect-ratio"><span class="header-section-number">5.13.3</span> Fixed Aspect Ratio</a></li>
  </ul></li>
  <li><a href="#saving-plots-with-ggsave" id="toc-saving-plots-with-ggsave" class="nav-link" data-scroll-target="#saving-plots-with-ggsave"><span class="header-section-number">5.14</span> Saving Plots with <code>ggsave()</code></a>
  <ul class="collapse">
  <li><a href="#common-arguments" id="toc-common-arguments" class="nav-link" data-scroll-target="#common-arguments"><span class="header-section-number">5.14.1</span> Common Arguments</a></li>
  <li><a href="#file-formats" id="toc-file-formats" class="nav-link" data-scroll-target="#file-formats"><span class="header-section-number">5.14.2</span> File Formats</a></li>
  </ul></li>
  <li><a href="#summary-choosing-the-right-plot-type" id="toc-summary-choosing-the-right-plot-type" class="nav-link" data-scroll-target="#summary-choosing-the-right-plot-type"><span class="header-section-number">5.15</span> Summary: Choosing the Right Plot Type</a>
  <ul class="collapse">
  <li><a href="#key-concepts-review" id="toc-key-concepts-review" class="nav-link" data-scroll-target="#key-concepts-review"><span class="header-section-number">5.15.1</span> Key Concepts Review</a></li>
  </ul></li>
  <li><a href="#week-5-homework-creating-publication-ready-plots" id="toc-week-5-homework-creating-publication-ready-plots" class="nav-link" data-scroll-target="#week-5-homework-creating-publication-ready-plots"><span class="header-section-number">5.16</span> Week 5 Homework: Creating Publication-Ready Plots</a>
  <ul class="collapse">
  <li><a href="#assignment-overview" id="toc-assignment-overview" class="nav-link" data-scroll-target="#assignment-overview"><span class="header-section-number">5.16.1</span> Assignment Overview</a></li>
  <li><a href="#dataset" id="toc-dataset" class="nav-link" data-scroll-target="#dataset"><span class="header-section-number">5.16.2</span> Dataset</a></li>
  <li><a href="#part-1-scatter-plot-20-points" id="toc-part-1-scatter-plot-20-points" class="nav-link" data-scroll-target="#part-1-scatter-plot-20-points"><span class="header-section-number">5.16.3</span> Part 1: Scatter Plot (20 points)</a></li>
  <li><a href="#part-2-line-plot-20-points" id="toc-part-2-line-plot-20-points" class="nav-link" data-scroll-target="#part-2-line-plot-20-points"><span class="header-section-number">5.16.4</span> Part 2: Line Plot (20 points)</a></li>
  <li><a href="#part-3-bar-chart-20-points" id="toc-part-3-bar-chart-20-points" class="nav-link" data-scroll-target="#part-3-bar-chart-20-points"><span class="header-section-number">5.16.5</span> Part 3: Bar Chart (20 points)</a></li>
  <li><a href="#part-4-histogram-15-points" id="toc-part-4-histogram-15-points" class="nav-link" data-scroll-target="#part-4-histogram-15-points"><span class="header-section-number">5.16.6</span> Part 4: Histogram (15 points)</a></li>
  <li><a href="#part-5-box-plot-or-violin-plot-20-points" id="toc-part-5-box-plot-or-violin-plot-20-points" class="nav-link" data-scroll-target="#part-5-box-plot-or-violin-plot-20-points"><span class="header-section-number">5.16.7</span> Part 5: Box Plot or Violin Plot (20 points)</a></li>
  <li><a href="#part-6-interpretation-5-points" id="toc-part-6-interpretation-5-points" class="nav-link" data-scroll-target="#part-6-interpretation-5-points"><span class="header-section-number">5.16.8</span> Part 6: Interpretation (5 points)</a></li>
  <li><a href="#bonus-challenge-10-points" id="toc-bonus-challenge-10-points" class="nav-link" data-scroll-target="#bonus-challenge-10-points"><span class="header-section-number">5.16.9</span> Bonus Challenge (+10 points)</a></li>
  <li><a href="#submission-requirements" id="toc-submission-requirements" class="nav-link" data-scroll-target="#submission-requirements"><span class="header-section-number">5.16.10</span> Submission Requirements</a></li>
  <li><a href="#recommended-yaml" id="toc-recommended-yaml" class="nav-link" data-scroll-target="#recommended-yaml"><span class="header-section-number">5.16.11</span> Recommended YAML</a></li>
  <li><a href="#grading-rubric" id="toc-grading-rubric" class="nav-link" data-scroll-target="#grading-rubric"><span class="header-section-number">5.16.12</span> Grading Rubric</a></li>
  </ul></li>
  <li><a href="#additional-resources" id="toc-additional-resources" class="nav-link" data-scroll-target="#additional-resources"><span class="header-section-number">5.17</span> Additional Resources</a>
  <ul class="collapse">
  <li><a href="#required-reading" id="toc-required-reading" class="nav-link" data-scroll-target="#required-reading"><span class="header-section-number">5.17.1</span> Required Reading</a></li>
  <li><a href="#optional-reading" id="toc-optional-reading" class="nav-link" data-scroll-target="#optional-reading"><span class="header-section-number">5.17.2</span> Optional Reading</a></li>
  <li><a href="#videos" id="toc-videos" class="nav-link" data-scroll-target="#videos"><span class="header-section-number">5.17.3</span> Videos</a></li>
  <li><a href="#cheat-sheets" id="toc-cheat-sheets" class="nav-link" data-scroll-target="#cheat-sheets"><span class="header-section-number">5.17.4</span> Cheat Sheets</a></li>
  <li><a href="#galleries-and-inspiration" id="toc-galleries-and-inspiration" class="nav-link" data-scroll-target="#galleries-and-inspiration"><span class="header-section-number">5.17.5</span> Galleries and Inspiration</a></li>
  <li><a href="#color-resources" id="toc-color-resources" class="nav-link" data-scroll-target="#color-resources"><span class="header-section-number">5.17.6</span> Color Resources</a></li>
  <li><a href="#interactive-learning" id="toc-interactive-learning" class="nav-link" data-scroll-target="#interactive-learning"><span class="header-section-number">5.17.7</span> Interactive Learning</a></li>
  <li><a href="#useful-websites" id="toc-useful-websites" class="nav-link" data-scroll-target="#useful-websites"><span class="header-section-number">5.17.8</span> Useful Websites</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/ch01-foundations.html">Part 1: Introduction to Data Science</a></li><li class="breadcrumb-item"><a href="../chapters/ch05-ggplot2_intro.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to Data Visualization with ggplot2</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to Data Visualization with ggplot2</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="learning-objectives" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="learning-objectives"><span class="header-section-number">5.1</span> Learning Objectives</h2>
<p>By the end of this chapter, you will be able to:</p>
<ol type="1">
<li>Understand the Grammar of Graphics philosophy and how ggplot2 implements it</li>
<li>Create scatter plots, line plots, bar charts, histograms, box plots, and violin plots</li>
<li>Map variables to aesthetic properties (color, size, shape, alpha)</li>
<li>Apply and customize themes for publication-ready plots</li>
<li>Add labels, titles, and customize scales</li>
<li>Save plots with <code>ggsave()</code> for different output formats</li>
<li>Choose the appropriate plot type for your data and research question</li>
</ol>
<hr>
</section>
<section id="introduction-to-the-grammar-of-graphics" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="introduction-to-the-grammar-of-graphics"><span class="header-section-number">5.2</span> Introduction to the Grammar of Graphics</h2>
<section id="what-is-ggplot2" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="what-is-ggplot2"><span class="header-section-number">5.2.1</span> What is ggplot2?</h3>
<p><code>ggplot2</code> is R’s most powerful and popular data visualization package. Created by Hadley Wickham, it implements Leland Wilkinson’s <strong>Grammar of Graphics</strong> — a systematic way to describe and build any visualization.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Why “gg”plot2?
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>gg</strong> = Grammar of Graphics</li>
<li><strong>2</strong> = Second iteration (there was a ggplot1, but it’s obsolete)</li>
</ul>
<p>The package is part of the tidyverse and integrates seamlessly with dplyr, tidyr, and other tidyverse tools.</p>
</div>
</div>
</section>
<section id="the-grammar-of-graphics-philosophy" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="the-grammar-of-graphics-philosophy"><span class="header-section-number">5.2.2</span> The Grammar of Graphics Philosophy</h3>
<p>Traditional plotting systems (like base R graphics) force you to choose from predefined plot types. The Grammar of Graphics takes a different approach: <strong>every visualization is built by combining independent components</strong>.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    A[Data] --&gt; B[Aesthetic Mappings]
    B --&gt; C[Geometric Objects]
    C --&gt; D[Statistical Transformations]
    D --&gt; E[Scales]
    E --&gt; F[Coordinate System]
    F --&gt; G[Facets]
    G --&gt; H[Theme]
    H --&gt; I[Final Plot]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="the-three-essential-components" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="the-three-essential-components"><span class="header-section-number">5.2.3</span> The Three Essential Components</h3>
<p>Every ggplot2 plot requires three components:</p>
<ol type="1">
<li><strong>Data</strong>: A data frame or tibble</li>
<li><strong>Aesthetic mappings</strong> (<code>aes()</code>): How variables map to visual properties (x, y, color, size, etc.)</li>
<li><strong>Geometric objects</strong> (<code>geom_*()</code>): The type of plot (points, lines, bars, etc.)</li>
</ol>
<p><strong>Basic syntax</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="sc">&lt;</span>DATA<span class="sc">&gt;</span>) <span class="sc">+</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">&lt;</span>X_VAR<span class="sc">&gt;</span>, <span class="at">y =</span> <span class="sc">&lt;</span>Y_VAR<span class="sc">&gt;</span>) <span class="sc">+</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  geom_<span class="sc">&lt;</span>TYPE<span class="sc">&gt;</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Or more commonly:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="sc">&lt;</span>DATA<span class="sc">&gt;</span>, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">&lt;</span>X_VAR<span class="sc">&gt;</span>, <span class="at">y =</span> <span class="sc">&lt;</span>Y_VAR<span class="sc">&gt;</span>)) <span class="sc">+</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  geom_<span class="sc">&lt;</span>TYPE<span class="sc">&gt;</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>ggplot2 Uses <code>+</code>, Not <code>%&gt;%</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Notice we use <code>+</code> to add layers to a ggplot, NOT the pipe (<code>%&gt;%</code> or <code>|&gt;</code>). This is a common mistake!</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CORRECT</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> var1, <span class="at">y =</span> var2)) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># WRONG - don't use pipe!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> var1, <span class="at">y =</span> var2)) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</section>
<section id="setup" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="setup"><span class="header-section-number">5.2.4</span> Setup</h3>
<p>Let’s load the necessary packages:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)  <span class="co"># Includes ggplot2, dplyr, etc.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
</section>
<section id="your-first-ggplot-scatter-plots-with-geom_point" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="your-first-ggplot-scatter-plots-with-geom_point"><span class="header-section-number">5.3</span> Your First ggplot: Scatter Plots with <code>geom_point()</code></h2>
<p>Scatter plots display the relationship between two continuous variables. Each observation is represented by a point.</p>
<section id="basic-scatter-plot" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="basic-scatter-plot"><span class="header-section-number">5.3.1</span> Basic Scatter Plot</h3>
<p>Let’s create example data on cattle feed intake and weight gain:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create example cattle data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>cattle <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">animal_id =</span> <span class="fu">paste0</span>(<span class="st">"C"</span>, <span class="dv">1001</span><span class="sc">:</span><span class="dv">1030</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">breed =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Holstein"</span>, <span class="st">"Jersey"</span>, <span class="st">"Angus"</span>), <span class="at">each =</span> <span class="dv">10</span>),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">feed_intake_kg =</span> <span class="fu">c</span>(</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">3</span>),  <span class="co"># Holstein</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">18</span>, <span class="at">sd =</span> <span class="dv">2</span>),  <span class="co"># Jersey</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">22</span>, <span class="at">sd =</span> <span class="fl">2.5</span>) <span class="co"># Angus</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight_gain_kg =</span> <span class="fu">c</span>(</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="fl">1.2</span>, <span class="at">sd =</span> <span class="fl">0.15</span>),  <span class="co"># Holstein</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="fl">0.8</span>, <span class="at">sd =</span> <span class="fl">0.12</span>),  <span class="co"># Jersey</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="fl">1.0</span>, <span class="at">sd =</span> <span class="fl">0.13</span>)   <span class="co"># Angus</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># View first few rows</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cattle)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  animal_id breed    feed_intake_kg weight_gain_kg
  &lt;chr&gt;     &lt;chr&gt;             &lt;dbl&gt;          &lt;dbl&gt;
1 C1001     Holstein           23.3          1.39 
2 C1002     Holstein           24.0          1.17 
3 C1003     Holstein           24.2          1.14 
4 C1004     Holstein           19.4          0.991
5 C1005     Holstein           26.0          0.976
6 C1006     Holstein           23.5          1.16 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create basic scatter plot</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg)) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Reading this code:</strong></p>
<ol type="1">
<li><code>ggplot(cattle, ...)</code> — Use the cattle data</li>
<li><code>aes(x = feed_intake_kg, y = weight_gain_kg)</code> — Map feed intake to x-axis, weight gain to y-axis</li>
<li><code>geom_point()</code> — Draw points</li>
</ol>
</section>
<section id="adding-color-by-group" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="adding-color-by-group"><span class="header-section-number">5.3.2</span> Adding Color by Group</h3>
<p>We can map the <code>breed</code> variable to color:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg, <span class="at">color =</span> breed)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Notice: - Each breed gets a different color automatically - A legend is created automatically - Colors are chosen from a default palette</p>
</section>
<section id="customizing-point-aesthetics" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="customizing-point-aesthetics"><span class="header-section-number">5.3.3</span> Customizing Point Aesthetics</h3>
<p>Points have several aesthetic properties we can map to variables OR set manually:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Aesthetic</th>
<th>What it controls</th>
<th>Example variable type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>x</code></td>
<td>Horizontal position</td>
<td>Continuous</td>
</tr>
<tr class="even">
<td><code>y</code></td>
<td>Vertical position</td>
<td>Continuous</td>
</tr>
<tr class="odd">
<td><code>color</code></td>
<td>Point outline color</td>
<td>Categorical or continuous</td>
</tr>
<tr class="even">
<td><code>size</code></td>
<td>Point size</td>
<td>Continuous</td>
</tr>
<tr class="odd">
<td><code>shape</code></td>
<td>Point shape</td>
<td>Categorical</td>
</tr>
<tr class="even">
<td><code>alpha</code></td>
<td>Transparency (0-1)</td>
<td>Continuous</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Mapping vs Setting
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Mapping</strong> (inside <code>aes()</code>): Connects a variable to an aesthetic — varies by data</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">color =</span> breed)  <span class="co"># Color depends on breed variable</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Setting</strong> (outside <code>aes()</code>): Sets a fixed value for all points</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>)  <span class="co"># All points blue and size 3</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<section id="example-mapping-size" class="level4" data-number="5.3.3.1">
<h4 data-number="5.3.3.1" class="anchored" data-anchor-id="example-mapping-size"><span class="header-section-number">5.3.3.1</span> Example: Mapping Size</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Map size to feed intake (redundant with x, but demonstrates the concept)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> breed, <span class="at">size =</span> feed_intake_kg)) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="example-setting-fixed-aesthetics" class="level4" data-number="5.3.3.2">
<h4 data-number="5.3.3.2" class="anchored" data-anchor-id="example-setting-fixed-aesthetics"><span class="header-section-number">5.3.3.2</span> Example: Setting Fixed Aesthetics</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make all points larger and semi-transparent</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg, <span class="at">color =</span> breed)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="example-using-shape" class="level4" data-number="5.3.3.3">
<h4 data-number="5.3.3.3" class="anchored" data-anchor-id="example-using-shape"><span class="header-section-number">5.3.3.3</span> Example: Using Shape</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Map shape to breed (in addition to color)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> breed, <span class="at">shape =</span> breed)) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="when-to-use-scatter-plots" class="level3" data-number="5.3.4">
<h3 data-number="5.3.4" class="anchored" data-anchor-id="when-to-use-scatter-plots"><span class="header-section-number">5.3.4</span> When to Use Scatter Plots</h3>
<p>✅ <strong>Use scatter plots when:</strong> - You have two continuous variables - You want to explore relationships/correlations - You want to identify outliers or patterns - You want to show individual data points</p>
<p>❌ <strong>Don’t use scatter plots when:</strong> - One or both variables are categorical (use bar charts or box plots) - You have too many overlapping points (consider hex bins or contour plots) - You want to show change over time for a single entity (use line plots)</p>
<hr>
</section>
</section>
<section id="line-plots-with-geom_line" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="line-plots-with-geom_line"><span class="header-section-number">5.4</span> Line Plots with <code>geom_line()</code></h2>
<p>Line plots connect points in order, typically used for time series or sequential data.</p>
<section id="example-growth-curves" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="example-growth-curves"><span class="header-section-number">5.4.1</span> Example: Growth Curves</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create growth data for individual animals over time</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>growth <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">animal_id =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"H001"</span>, <span class="st">"H002"</span>, <span class="st">"H003"</span>), <span class="at">each =</span> <span class="dv">6</span>),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">week =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>), <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight_kg =</span> <span class="fu">c</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">58</span>, <span class="dv">72</span>, <span class="dv">88</span>, <span class="dv">105</span>, <span class="dv">122</span>),  <span class="co"># H001</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">42</span>, <span class="dv">55</span>, <span class="dv">68</span>, <span class="dv">83</span>, <span class="dv">98</span>, <span class="dv">115</span>),   <span class="co"># H002</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">48</span>, <span class="dv">60</span>, <span class="dv">75</span>, <span class="dv">91</span>, <span class="dv">108</span>, <span class="dv">126</span>)   <span class="co"># H003</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>growth</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 3
   animal_id  week weight_kg
   &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 H001          0        45
 2 H001          2        58
 3 H001          4        72
 4 H001          6        88
 5 H001          8       105
 6 H001         10       122
 7 H002          0        42
 8 H002          2        55
 9 H002          4        68
10 H002          6        83
11 H002          8        98
12 H002         10       115
13 H003          0        48
14 H003          2        60
15 H003          4        75
16 H003          6        91
17 H003          8       108
18 H003         10       126</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create line plot</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(growth, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> weight_kg, <span class="at">color =</span> animal_id)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="combining-lines-and-points" class="level3" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="combining-lines-and-points"><span class="header-section-number">5.4.2</span> Combining Lines and Points</h3>
<p>Often, it’s helpful to show both the line and the data points:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(growth, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> weight_kg, <span class="at">color =</span> animal_id)) <span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Layer Order Matters
</div>
</div>
<div class="callout-body-container callout-body">
<p>Layers are drawn in the order you add them. Later layers appear on top of earlier layers.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Points on top of lines (usually preferred)</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Lines on top of points (can obscure data)</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</section>
<section id="customizing-lines" class="level3" data-number="5.4.3">
<h3 data-number="5.4.3" class="anchored" data-anchor-id="customizing-lines"><span class="header-section-number">5.4.3</span> Customizing Lines</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Thicker lines with different line types</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(growth, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> weight_kg, <span class="at">color =</span> animal_id)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="when-to-use-line-plots" class="level3" data-number="5.4.4">
<h3 data-number="5.4.4" class="anchored" data-anchor-id="when-to-use-line-plots"><span class="header-section-number">5.4.4</span> When to Use Line Plots</h3>
<p>✅ <strong>Use line plots when:</strong> - Data represents a sequence (especially time) - You want to show trends or changes - Points should be connected in a specific order - You’re tracking individual subjects over time</p>
<p>❌ <strong>Don’t use line plots when:</strong> - Data points are independent (no meaningful order) - You have many overlapping trajectories (hard to read) - X-axis is not continuous or sequential</p>
<hr>
</section>
</section>
<section id="bar-charts-with-geom_col-and-geom_bar" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="bar-charts-with-geom_col-and-geom_bar"><span class="header-section-number">5.5</span> Bar Charts with <code>geom_col()</code> and <code>geom_bar()</code></h2>
<p>Bar charts display categorical data with rectangular bars.</p>
<section id="geom_col-vs-geom_bar" class="level3" data-number="5.5.1">
<h3 data-number="5.5.1" class="anchored" data-anchor-id="geom_col-vs-geom_bar"><span class="header-section-number">5.5.1</span> <code>geom_col()</code> vs <code>geom_bar()</code></h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Function</th>
<th>When to use</th>
<th>Y-axis comes from</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>geom_col()</code></td>
<td>You’ve already calculated the values</td>
<td>Your data</td>
</tr>
<tr class="even">
<td><code>geom_bar()</code></td>
<td>You want to count occurrences</td>
<td>Automatic counting</td>
</tr>
</tbody>
</table>
</section>
<section id="using-geom_col-with-pre-calculated-values" class="level3" data-number="5.5.2">
<h3 data-number="5.5.2" class="anchored" data-anchor-id="using-geom_col-with-pre-calculated-values"><span class="header-section-number">5.5.2</span> Using <code>geom_col()</code> with Pre-calculated Values</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Average milk production by breed (already summarized)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>milk_production <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">breed =</span> <span class="fu">c</span>(<span class="st">"Holstein"</span>, <span class="st">"Jersey"</span>, <span class="st">"Guernsey"</span>, <span class="st">"Brown Swiss"</span>),</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">avg_liters_per_day =</span> <span class="fu">c</span>(<span class="dv">35</span>, <span class="dv">24</span>, <span class="dv">28</span>, <span class="dv">30</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>milk_production</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  breed       avg_liters_per_day
  &lt;chr&gt;                    &lt;dbl&gt;
1 Holstein                    35
2 Jersey                      24
3 Guernsey                    28
4 Brown Swiss                 30</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create bar chart</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(milk_production, <span class="fu">aes</span>(<span class="at">x =</span> breed, <span class="at">y =</span> avg_liters_per_day)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="using-geom_bar-to-count" class="level3" data-number="5.5.3">
<h3 data-number="5.5.3" class="anchored" data-anchor-id="using-geom_bar-to-count"><span class="header-section-number">5.5.3</span> Using <code>geom_bar()</code> to Count</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset with individual animals</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>animals <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">breed =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Holstein"</span>, <span class="st">"Jersey"</span>, <span class="st">"Angus"</span>), <span class="at">size =</span> <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Count animals per breed automatically</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(animals, <span class="fu">aes</span>(<span class="at">x =</span> breed)) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span><code>geom_bar()</code> Counts for You
</div>
</div>
<div class="callout-body-container callout-body">
<p>When you use <code>geom_bar()</code>, you only specify <code>x</code> (the categorical variable). The y-axis (count) is calculated automatically using <code>stat = "count"</code>.</p>
</div>
</div>
</section>
<section id="adding-color" class="level3" data-number="5.5.4">
<h3 data-number="5.5.4" class="anchored" data-anchor-id="adding-color"><span class="header-section-number">5.5.4</span> Adding Color</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Color bars by breed</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(milk_production, <span class="fu">aes</span>(<span class="at">x =</span> breed, <span class="at">y =</span> avg_liters_per_day, <span class="at">fill =</span> breed)) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span><code>color</code> vs <code>fill</code> for Bars
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>color</code> controls the <strong>outline</strong> of the bar</li>
<li><code>fill</code> controls the <strong>inside</strong> of the bar</li>
</ul>
<p>Usually, you want <code>fill</code> for bar charts:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">fill =</span> breed)  <span class="co"># Fills the bars (typical)</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">color =</span> breed) <span class="co"># Just colors the outlines (usually not what you want)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</section>
<section id="grouped-and-stacked-bars" class="level3" data-number="5.5.5">
<h3 data-number="5.5.5" class="anchored" data-anchor-id="grouped-and-stacked-bars"><span class="header-section-number">5.5.5</span> Grouped and Stacked Bars</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data with two categorical variables</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>feed_trial <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">breed =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Holstein"</span>, <span class="st">"Jersey"</span>), <span class="at">each =</span> <span class="dv">3</span>),</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">feed_type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">times =</span> <span class="dv">2</span>),</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">avg_gain_kg =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">1.4</span>, <span class="fl">1.1</span>, <span class="fl">0.9</span>, <span class="fl">1.0</span>, <span class="fl">0.8</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>feed_trial</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  breed    feed_type avg_gain_kg
  &lt;chr&gt;    &lt;chr&gt;           &lt;dbl&gt;
1 Holstein A                 1.2
2 Holstein B                 1.4
3 Holstein C                 1.1
4 Jersey   A                 0.9
5 Jersey   B                 1  
6 Jersey   C                 0.8</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grouped bars</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(feed_trial, <span class="fu">aes</span>(<span class="at">x =</span> breed, <span class="at">y =</span> avg_gain_kg, <span class="at">fill =</span> feed_type)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stacked bars (default)</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(feed_trial, <span class="fu">aes</span>(<span class="at">x =</span> breed, <span class="at">y =</span> avg_gain_kg, <span class="at">fill =</span> feed_type)) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="horizontal-bars" class="level3" data-number="5.5.6">
<h3 data-number="5.5.6" class="anchored" data-anchor-id="horizontal-bars"><span class="header-section-number">5.5.6</span> Horizontal Bars</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use coord_flip() for horizontal bars</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(milk_production, <span class="fu">aes</span>(<span class="at">x =</span> breed, <span class="at">y =</span> avg_liters_per_day)) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="when-to-use-bar-charts" class="level3" data-number="5.5.7">
<h3 data-number="5.5.7" class="anchored" data-anchor-id="when-to-use-bar-charts"><span class="header-section-number">5.5.7</span> When to Use Bar Charts</h3>
<p>✅ <strong>Use bar charts when:</strong> - Comparing quantities across categories - Showing counts or frequencies - Categories are on the x-axis - Bars should start at zero</p>
<p>❌ <strong>Don’t use bar charts when:</strong> - Showing distributions (use histograms) - Comparing many categories (can be hard to read) - Changes over time are important (use line plots)</p>
<hr>
</section>
</section>
<section id="histograms-with-geom_histogram" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="histograms-with-geom_histogram"><span class="header-section-number">5.6</span> Histograms with <code>geom_histogram()</code></h2>
<p>Histograms show the <strong>distribution</strong> of a single continuous variable by dividing the data into bins and counting how many observations fall into each bin.</p>
<section id="basic-histogram" class="level3" data-number="5.6.1">
<h3 data-number="5.6.1" class="anchored" data-anchor-id="basic-histogram"><span class="header-section-number">5.6.1</span> Basic Histogram</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create birth weight data</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>birth_weights <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">calf_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">birth_weight_kg =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="at">mean =</span> <span class="dv">40</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birth_weights, <span class="fu">aes</span>(<span class="at">x =</span> birth_weight_kg)) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Pick the Right Number of Bins!
</div>
</div>
<div class="callout-body-container callout-body">
<p>The default number of bins (30) may not be ideal for your data. Experiment with:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>)      <span class="co"># Specify number of bins</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>)   <span class="co"># Specify width of each bin</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Too few bins → lose detail; too many bins → noisy</p>
</div>
</div>
</section>
<section id="customizing-binwidth" class="level3" data-number="5.6.2">
<h3 data-number="5.6.2" class="anchored" data-anchor-id="customizing-binwidth"><span class="header-section-number">5.6.2</span> Customizing Binwidth</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wider bins (3 kg)</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birth_weights, <span class="fu">aes</span>(<span class="at">x =</span> birth_weight_kg)) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="overlapping-histograms-by-group" class="level3" data-number="5.6.3">
<h3 data-number="5.6.3" class="anchored" data-anchor-id="overlapping-histograms-by-group"><span class="header-section-number">5.6.3</span> Overlapping Histograms by Group</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create breed data with different distributions</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>breeds_vec <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Holstein"</span>, <span class="st">"Jersey"</span>), <span class="at">size =</span> <span class="dv">200</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>birth_weights_breed <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">breed =</span> breeds_vec,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">birth_weight_kg =</span> <span class="fu">ifelse</span>(</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    breed <span class="sc">==</span> <span class="st">"Holstein"</span>,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="fu">sum</span>(breed <span class="sc">==</span> <span class="st">"Holstein"</span>), <span class="at">mean =</span> <span class="dv">42</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="fu">sum</span>(breed <span class="sc">==</span> <span class="st">"Jersey"</span>), <span class="at">mean =</span> <span class="dv">37</span>, <span class="at">sd =</span> <span class="dv">4</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlapping histograms</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birth_weights_breed, <span class="fu">aes</span>(<span class="at">x =</span> birth_weight_kg, <span class="at">fill =</span> breed)) <span class="sc">+</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Use <code>alpha</code> for Overlapping Histograms
</div>
</div>
<div class="callout-body-container callout-body">
<p>When showing multiple distributions, use <code>alpha</code> (transparency) so you can see where they overlap:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_histogram</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><code>position = "identity"</code> places histograms on top of each other (default is stacked).</p>
</div>
</div>
</section>
<section id="when-to-use-histograms" class="level3" data-number="5.6.4">
<h3 data-number="5.6.4" class="anchored" data-anchor-id="when-to-use-histograms"><span class="header-section-number">5.6.4</span> When to Use Histograms</h3>
<p>✅ <strong>Use histograms when:</strong> - Showing the distribution of a continuous variable - Checking for normality - Identifying skewness or outliers - Understanding the shape of your data</p>
<p>❌ <strong>Don’t use histograms when:</strong> - You have categorical data (use bar charts) - Comparing multiple groups precisely (use box plots or density plots) - You have very few data points (distributions won’t be clear)</p>
<hr>
</section>
</section>
<section id="box-plots-with-geom_boxplot" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="box-plots-with-geom_boxplot"><span class="header-section-number">5.7</span> Box Plots with <code>geom_boxplot()</code></h2>
<p>Box plots (box-and-whisker plots) display the distribution of data through five summary statistics: minimum, first quartile (Q1), median, third quartile (Q3), and maximum.</p>
<section id="anatomy-of-a-box-plot" class="level3" data-number="5.7.1">
<h3 data-number="5.7.1" class="anchored" data-anchor-id="anatomy-of-a-box-plot"><span class="header-section-number">5.7.1</span> Anatomy of a Box Plot</h3>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TD
    A[Box Plot Components] --&gt; B[Box: IQR Q1 to Q3]
    A --&gt; C[Line in box: Median]
    A --&gt; D[Whiskers: 1.5 × IQR]
    A --&gt; E[Points beyond whiskers: Outliers]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="basic-box-plot" class="level3" data-number="5.7.2">
<h3 data-number="5.7.2" class="anchored" data-anchor-id="basic-box-plot"><span class="header-section-number">5.7.2</span> Basic Box Plot</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for different treatment groups</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>treatments <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Drug A"</span>, <span class="st">"Drug B"</span>, <span class="st">"Drug C"</span>), <span class="at">each =</span> <span class="dv">25</span>),</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight_gain_kg =</span> <span class="fu">c</span>(</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">8</span>),   <span class="co"># Control</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="dv">58</span>, <span class="at">sd =</span> <span class="dv">7</span>),   <span class="co"># Drug A</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="dv">62</span>, <span class="at">sd =</span> <span class="dv">9</span>),   <span class="co"># Drug B</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="dv">55</span>, <span class="at">sd =</span> <span class="dv">6</span>)    <span class="co"># Drug C</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(treatments, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> weight_gain_kg)) <span class="sc">+</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="adding-color-1" class="level3" data-number="5.7.3">
<h3 data-number="5.7.3" class="anchored" data-anchor-id="adding-color-1"><span class="header-section-number">5.7.3</span> Adding Color</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(treatments, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> weight_gain_kg, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="combining-box-plots-with-individual-points" class="level3" data-number="5.7.4">
<h3 data-number="5.7.4" class="anchored" data-anchor-id="combining-box-plots-with-individual-points"><span class="header-section-number">5.7.4</span> Combining Box Plots with Individual Points</h3>
<p>It’s often useful to show the underlying data along with the box plot:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add jittered points</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(treatments, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> weight_gain_kg, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span><code>geom_jitter()</code> Reduces Overplotting
</div>
</div>
<div class="callout-body-container callout-body">
<p>When points overlap, <code>geom_jitter()</code> adds small random horizontal noise to make them visible:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>)  <span class="co"># Jitter horizontally (adjust width as needed)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</section>
<section id="when-to-use-box-plots" class="level3" data-number="5.7.5">
<h3 data-number="5.7.5" class="anchored" data-anchor-id="when-to-use-box-plots"><span class="header-section-number">5.7.5</span> When to Use Box Plots</h3>
<p>✅ <strong>Use box plots when:</strong> - Comparing distributions across groups - You want to show median, quartiles, and outliers - You have multiple groups to compare - You want a compact summary of distributions</p>
<p>❌ <strong>Don’t use box plots when:</strong> - Your data has multiple modes (bimodal, multimodal) — box plots hide this - You have very few data points (&lt; ~10 per group) - You want to show exact distributions (use violin plots or histograms)</p>
<hr>
</section>
</section>
<section id="violin-plots-with-geom_violin" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="violin-plots-with-geom_violin"><span class="header-section-number">5.8</span> Violin Plots with <code>geom_violin()</code></h2>
<p>Violin plots show the full distribution of data (like a density plot) rotated and mirrored. They’re useful for showing distributions that box plots might hide.</p>
<section id="basic-violin-plot" class="level3" data-number="5.8.1">
<h3 data-number="5.8.1" class="anchored" data-anchor-id="basic-violin-plot"><span class="header-section-number">5.8.1</span> Basic Violin Plot</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(treatments, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> weight_gain_kg, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="combining-violin-plots-with-box-plots" class="level3" data-number="5.8.2">
<h3 data-number="5.8.2" class="anchored" data-anchor-id="combining-violin-plots-with-box-plots"><span class="header-section-number">5.8.2</span> Combining Violin Plots with Box Plots</h3>
<p>A powerful combination: violin plot shows distribution, box plot shows summary statistics:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(treatments, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> weight_gain_kg, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"white"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="adding-points" class="level3" data-number="5.8.3">
<h3 data-number="5.8.3" class="anchored" data-anchor-id="adding-points"><span class="header-section-number">5.8.3</span> Adding Points</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(treatments, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> weight_gain_kg, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="when-to-use-violin-plots" class="level3" data-number="5.8.4">
<h3 data-number="5.8.4" class="anchored" data-anchor-id="when-to-use-violin-plots"><span class="header-section-number">5.8.4</span> When to Use Violin Plots</h3>
<p>✅ <strong>Use violin plots when:</strong> - You want to show full distribution shape - Your data might be bimodal or have multiple peaks - Comparing distributions across groups - You have enough data points (&gt; ~20 per group)</p>
<p>❌ <strong>Don’t use violin plots when:</strong> - You have very few data points (distributions won’t be smooth) - Readers aren’t familiar with violin plots (less intuitive than box plots) - You only need summary statistics (use box plots)</p>
<hr>
</section>
</section>
<section id="aesthetic-mappings-a-deeper-dive" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="aesthetic-mappings-a-deeper-dive"><span class="header-section-number">5.9</span> Aesthetic Mappings: A Deeper Dive</h2>
<p>We’ve seen several aesthetics already. Let’s consolidate what we know:</p>
<section id="common-aesthetics" class="level3" data-number="5.9.1">
<h3 data-number="5.9.1" class="anchored" data-anchor-id="common-aesthetics"><span class="header-section-number">5.9.1</span> Common Aesthetics</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Aesthetic</th>
<th>Type</th>
<th>Example</th>
<th>Best used with</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>x</code></td>
<td>Position</td>
<td><code>aes(x = treatment)</code></td>
<td>All geoms</td>
</tr>
<tr class="even">
<td><code>y</code></td>
<td>Position</td>
<td><code>aes(y = weight)</code></td>
<td>All geoms</td>
</tr>
<tr class="odd">
<td><code>color</code></td>
<td>Color</td>
<td><code>aes(color = breed)</code></td>
<td>Points, lines, text</td>
</tr>
<tr class="even">
<td><code>fill</code></td>
<td>Fill</td>
<td><code>aes(fill = breed)</code></td>
<td>Bars, boxes, violins</td>
</tr>
<tr class="odd">
<td><code>size</code></td>
<td>Size</td>
<td><code>aes(size = age)</code></td>
<td>Points, text</td>
</tr>
<tr class="even">
<td><code>shape</code></td>
<td>Shape</td>
<td><code>aes(shape = sex)</code></td>
<td>Points</td>
</tr>
<tr class="odd">
<td><code>alpha</code></td>
<td>Transparency</td>
<td><code>aes(alpha = density)</code></td>
<td>All geoms</td>
</tr>
<tr class="even">
<td><code>linetype</code></td>
<td>Line type</td>
<td><code>aes(linetype = group)</code></td>
<td>Lines</td>
</tr>
</tbody>
</table>
</section>
<section id="continuous-vs-discrete-variables" class="level3" data-number="5.9.2">
<h3 data-number="5.9.2" class="anchored" data-anchor-id="continuous-vs-discrete-variables"><span class="header-section-number">5.9.2</span> Continuous vs Discrete Variables</h3>
<p>ggplot2 handles continuous and discrete variables differently:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data with both variable types</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>mixed_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">each =</span> <span class="dv">20</span>),  <span class="co"># Discrete</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">score =</span> <span class="fu">rnorm</span>(<span class="dv">60</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>),    <span class="co"># Continuous</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">intensity =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">times =</span> <span class="dv">3</span>)           <span class="co"># Continuous</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Color by discrete variable (gets distinct colors)</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mixed_data, <span class="fu">aes</span>(<span class="at">x =</span> intensity, <span class="at">y =</span> score, <span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Color by continuous variable (gets gradient)</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mixed_data, <span class="fu">aes</span>(<span class="at">x =</span> intensity, <span class="at">y =</span> score, <span class="at">color =</span> intensity)) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Choosing the Right Aesthetic
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Categorical data</strong>: Use <code>color</code>, <code>fill</code>, <code>shape</code>, <code>linetype</code></li>
<li><strong>Continuous data</strong>: Use <code>x</code>, <code>y</code>, <code>size</code>, <code>alpha</code>, <code>color</code> (gradient)</li>
<li><strong>Too many categories?</strong> (&gt; ~7): Don’t use <code>shape</code> (hard to distinguish); consider faceting instead</li>
</ul>
</div>
</div>
<hr>
</section>
</section>
<section id="working-with-scales" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="working-with-scales"><span class="header-section-number">5.10</span> Working with Scales</h2>
<p>Scales control how data values map to visual properties. Every aesthetic has a scale.</p>
<section id="scale-functions" class="level3" data-number="5.10.1">
<h3 data-number="5.10.1" class="anchored" data-anchor-id="scale-functions"><span class="header-section-number">5.10.1</span> Scale Functions</h3>
<p>Scale functions follow the pattern: <code>scale_&lt;aesthetic&gt;_&lt;type&gt;()</code></p>
<p>Examples: - <code>scale_x_continuous()</code> — Continuous x-axis - <code>scale_y_log10()</code> — Log10 transform y-axis - <code>scale_color_manual()</code> — Manually specify colors - <code>scale_fill_brewer()</code> — Use ColorBrewer palettes</p>
</section>
<section id="modifying-continuous-scales" class="level3" data-number="5.10.2">
<h3 data-number="5.10.2" class="anchored" data-anchor-id="modifying-continuous-scales"><span class="header-section-number">5.10.2</span> Modifying Continuous Scales</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>growth_rate <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">animal_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight_kg =</span> <span class="fu">runif</span>(<span class="dv">30</span>, <span class="at">min =</span> <span class="dv">400</span>, <span class="at">max =</span> <span class="dv">700</span>),</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">gain_per_day_kg =</span> <span class="fu">runif</span>(<span class="dv">30</span>, <span class="at">min =</span> <span class="fl">0.8</span>, <span class="at">max =</span> <span class="fl">1.5</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify axis limits and breaks</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(growth_rate, <span class="fu">aes</span>(<span class="at">x =</span> weight_kg, <span class="at">y =</span> gain_per_day_kg)) <span class="sc">+</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">350</span>, <span class="dv">750</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">350</span>, <span class="dv">750</span>, <span class="at">by =</span> <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.5</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="log-transformations" class="level3" data-number="5.10.3">
<h3 data-number="5.10.3" class="anchored" data-anchor-id="log-transformations"><span class="header-section-number">5.10.3</span> Log Transformations</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data with exponential relationship</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>bacteria <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_hours =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">24</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">count =</span> <span class="dv">100</span> <span class="sc">*</span> <span class="dv">2</span><span class="sc">^</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">24</span> <span class="sc">/</span> <span class="dv">4</span>)  <span class="co"># Exponential growth</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Regular scale (hard to see early values)</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bacteria, <span class="fu">aes</span>(<span class="at">x =</span> time_hours, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Log scale (easier to see pattern)</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bacteria, <span class="fu">aes</span>(<span class="at">x =</span> time_hours, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="discrete-scales-manual-colors" class="level3" data-number="5.10.4">
<h3 data-number="5.10.4" class="anchored" data-anchor-id="discrete-scales-manual-colors"><span class="header-section-number">5.10.4</span> Discrete Scales: Manual Colors</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify custom colors</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg, <span class="at">color =</span> breed)) <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Holstein"</span> <span class="ot">=</span> <span class="st">"blue"</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Jersey"</span> <span class="ot">=</span> <span class="st">"orange"</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Angus"</span> <span class="ot">=</span> <span class="st">"darkred"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="using-colorbrewer-palettes" class="level3" data-number="5.10.5">
<h3 data-number="5.10.5" class="anchored" data-anchor-id="using-colorbrewer-palettes"><span class="header-section-number">5.10.5</span> Using ColorBrewer Palettes</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use ColorBrewer palette (colorblind-friendly)</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg, <span class="at">color =</span> breed)) <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Colorblind-Friendly Palettes
</div>
</div>
<div class="callout-body-container callout-body">
<p>Use <code>scale_color_viridis_d()</code> (discrete) or <code>scale_color_viridis_c()</code> (continuous) for accessible colors:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_color_viridis_d</span>()  <span class="co"># Discrete variable</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_color_viridis_c</span>()  <span class="co"># Continuous variable</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<hr>
</section>
</section>
<section id="labels-and-titles-with-labs" class="level2" data-number="5.11">
<h2 data-number="5.11" class="anchored" data-anchor-id="labels-and-titles-with-labs"><span class="header-section-number">5.11</span> Labels and Titles with <code>labs()</code></h2>
<p>Use <code>labs()</code> to add or modify plot labels:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg, <span class="at">color =</span> breed)) <span class="sc">+</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship Between Feed Intake and Weight Gain"</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Data from 30 cattle across three breeds"</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Daily Feed Intake (kg)"</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Daily Weight Gain (kg)"</span>,</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Breed"</span>,</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Source: Fictional farm data (2024)"</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Label Arguments in <code>labs()</code>
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>title</code> — Main plot title</li>
<li><code>subtitle</code> — Secondary title (smaller font)</li>
<li><code>x</code>, <code>y</code> — Axis labels</li>
<li><code>color</code>, <code>fill</code>, <code>shape</code>, <code>size</code> — Legend titles (match the aesthetic name)</li>
<li><code>caption</code> — Small text at bottom (often for data source or notes)</li>
</ul>
</div>
</div>
<hr>
</section>
<section id="themes-customizing-plot-appearance" class="level2" data-number="5.12">
<h2 data-number="5.12" class="anchored" data-anchor-id="themes-customizing-plot-appearance"><span class="header-section-number">5.12</span> Themes: Customizing Plot Appearance</h2>
<p>Themes control the non-data elements of your plot (background, grid lines, fonts, etc.).</p>
<section id="built-in-themes" class="level3" data-number="5.12.1">
<h3 data-number="5.12.1" class="anchored" data-anchor-id="built-in-themes"><span class="header-section-number">5.12.1</span> Built-in Themes</h3>
<p>ggplot2 includes several complete themes:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create base plot</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg, <span class="at">color =</span> breed)) <span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Feed Intake vs Weight Gain"</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Default theme (theme_gray)</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># theme_minimal() - Clean and modern</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># theme_classic() - No grid lines</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-32-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># theme_bw() - Black and white</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-32-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># theme_light() - Light gray grid</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_light</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-32-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="setting-a-default-theme" class="level3" data-number="5.12.2">
<h3 data-number="5.12.2" class="anchored" data-anchor-id="setting-a-default-theme"><span class="header-section-number">5.12.2</span> Setting a Default Theme</h3>
<p>You can set a theme for all plots in your session:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set default theme for all subsequent plots</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="customizing-themes" class="level3" data-number="5.12.3">
<h3 data-number="5.12.3" class="anchored" data-anchor-id="customizing-themes"><span class="header-section-number">5.12.3</span> Customizing Themes</h3>
<p>Use <code>theme()</code> to modify specific elements:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg, <span class="at">color =</span> breed)) <span class="sc">+</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Feed Intake vs Weight Gain"</span>) <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Common Theme Customizations
</div>
</div>
<div class="callout-body-container callout-body">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.position =</span> <span class="st">"bottom"</span>,  <span class="co"># or "top", "left", "right", "none"</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"gray90"</span>),</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<hr>
</section>
</section>
<section id="coordinate-systems" class="level2" data-number="5.13">
<h2 data-number="5.13" class="anchored" data-anchor-id="coordinate-systems"><span class="header-section-number">5.13</span> Coordinate Systems</h2>
<p>Coordinate systems control how the x and y axes are rendered.</p>
<section id="coord_cartesian-zooming" class="level3" data-number="5.13.1">
<h3 data-number="5.13.1" class="anchored" data-anchor-id="coord_cartesian-zooming"><span class="header-section-number">5.13.1</span> <code>coord_cartesian()</code>: Zooming</h3>
<p><code>coord_cartesian()</code> is useful for zooming without removing data:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Zoom in on a specific region</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg, <span class="at">color =</span> breed)) <span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">26</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">1.2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span><code>coord_cartesian()</code> vs <code>scale_*_continuous(limits = ...)</code>
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>coord_cartesian(xlim = c(a, b))</code> — <strong>Zooms</strong> without removing data (stat calculations use all data)</li>
<li><code>scale_x_continuous(limits = c(a, b))</code> — <strong>Removes</strong> data outside limits before plotting</li>
</ul>
<p>Usually, you want <code>coord_cartesian()</code> for zooming.</p>
</div>
</div>
</section>
<section id="coord_flip-horizontal-plots" class="level3" data-number="5.13.2">
<h3 data-number="5.13.2" class="anchored" data-anchor-id="coord_flip-horizontal-plots"><span class="header-section-number">5.13.2</span> <code>coord_flip()</code>: Horizontal Plots</h3>
<p>We saw this earlier with bar charts. It swaps x and y:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(milk_production, <span class="fu">aes</span>(<span class="at">x =</span> breed, <span class="at">y =</span> avg_liters_per_day)) <span class="sc">+</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="fixed-aspect-ratio" class="level3" data-number="5.13.3">
<h3 data-number="5.13.3" class="anchored" data-anchor-id="fixed-aspect-ratio"><span class="header-section-number">5.13.3</span> Fixed Aspect Ratio</h3>
<p><code>coord_fixed()</code> ensures equal scales on both axes (1 unit on x = 1 unit on y visually):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Without fixed aspect ratio</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg)) <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With fixed aspect ratio</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg)) <span class="sc">+</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> <span class="dv">20</span>)  <span class="co"># 20 kg of feed = 1 kg weight gain visually</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05-ggplot2_intro_files/figure-html/unnamed-chunk-37-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="saving-plots-with-ggsave" class="level2" data-number="5.14">
<h2 data-number="5.14" class="anchored" data-anchor-id="saving-plots-with-ggsave"><span class="header-section-number">5.14</span> Saving Plots with <code>ggsave()</code></h2>
<p>After creating a plot, save it with <code>ggsave()</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>my_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg, <span class="at">color =</span> breed)) <span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Feed Intake vs Weight Gain"</span>) <span class="sc">+</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Save to file</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"cattle_plot.png"</span>, <span class="at">plot =</span> my_plot, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="common-arguments" class="level3" data-number="5.14.1">
<h3 data-number="5.14.1" class="anchored" data-anchor-id="common-arguments"><span class="header-section-number">5.14.1</span> Common Arguments</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Argument</th>
<th>What it does</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>filename</code></td>
<td>File path and name</td>
<td><code>"plots/figure1.png"</code></td>
</tr>
<tr class="even">
<td><code>plot</code></td>
<td>ggplot object (defaults to last plot)</td>
<td><code>my_plot</code></td>
</tr>
<tr class="odd">
<td><code>width</code></td>
<td>Width in inches (or cm, mm)</td>
<td><code>8</code></td>
</tr>
<tr class="even">
<td><code>height</code></td>
<td>Height in inches (or cm, mm)</td>
<td><code>6</code></td>
</tr>
<tr class="odd">
<td><code>dpi</code></td>
<td>Resolution (dots per inch)</td>
<td><code>300</code> (publication quality)</td>
</tr>
<tr class="even">
<td><code>units</code></td>
<td>Units for width/height</td>
<td><code>"in"</code>, <code>"cm"</code>, <code>"mm"</code></td>
</tr>
</tbody>
</table>
</section>
<section id="file-formats" class="level3" data-number="5.14.2">
<h3 data-number="5.14.2" class="anchored" data-anchor-id="file-formats"><span class="header-section-number">5.14.2</span> File Formats</h3>
<p>ggplot2 supports many formats (determined by file extension):</p>
<ul>
<li><strong>PNG</strong> (<code>.png</code>) — Good for presentations, web (raster)</li>
<li><strong>PDF</strong> (<code>.pdf</code>) — Best for publications (vector, scalable)</li>
<li><strong>JPEG</strong> (<code>.jpg</code>) — Compressed (raster, smaller files)</li>
<li><strong>SVG</strong> (<code>.svg</code>) — Vector format for web</li>
<li><strong>TIFF</strong> (<code>.tiff</code>) — High quality (raster, large files)</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save as PDF (recommended for publications)</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"figure1.pdf"</span>, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save as high-resolution PNG</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"figure1.png"</span>, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Publication Guidelines
</div>
</div>
<div class="callout-body-container callout-body">
<p>Most journals require: - <strong>300 dpi</strong> minimum resolution - <strong>PDF</strong> or <strong>TIFF</strong> format for final submission - Specific dimensions (check journal guidelines) - Readable fonts (usually at least 8-10 pt in final figure)</p>
<p>Start with:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"figure.pdf"</span>, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<hr>
</section>
</section>
<section id="summary-choosing-the-right-plot-type" class="level2" data-number="5.15">
<h2 data-number="5.15" class="anchored" data-anchor-id="summary-choosing-the-right-plot-type"><span class="header-section-number">5.15</span> Summary: Choosing the Right Plot Type</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 17%">
<col style="width: 51%">
</colgroup>
<thead>
<tr class="header">
<th>Data Type</th>
<th>Goal</th>
<th>Recommended Plot</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2 continuous variables</td>
<td>Show relationship</td>
<td><strong>Scatter plot</strong> (<code>geom_point</code>)</td>
</tr>
<tr class="even">
<td>Time series</td>
<td>Show change over time</td>
<td><strong>Line plot</strong> (<code>geom_line</code>)</td>
</tr>
<tr class="odd">
<td>Categorical + continuous</td>
<td>Compare groups</td>
<td><strong>Bar chart</strong> (<code>geom_col</code>), <strong>Box plot</strong> (<code>geom_boxplot</code>)</td>
</tr>
<tr class="even">
<td>1 continuous variable</td>
<td>Show distribution</td>
<td><strong>Histogram</strong> (<code>geom_histogram</code>), <strong>Density plot</strong></td>
</tr>
<tr class="odd">
<td>Multiple groups + continuous</td>
<td>Compare distributions</td>
<td><strong>Box plot</strong> (<code>geom_boxplot</code>), <strong>Violin plot</strong> (<code>geom_violin</code>)</td>
</tr>
<tr class="even">
<td>Counts of categories</td>
<td>Show frequencies</td>
<td><strong>Bar chart</strong> (<code>geom_bar</code>)</td>
</tr>
</tbody>
</table>
<section id="key-concepts-review" class="level3" data-number="5.15.1">
<h3 data-number="5.15.1" class="anchored" data-anchor-id="key-concepts-review"><span class="header-section-number">5.15.1</span> Key Concepts Review</h3>
<ol type="1">
<li><strong>Three essentials</strong>: Data + <code>aes()</code> + <code>geom_*()</code></li>
<li><strong>Layers</strong>: Build plots by adding layers with <code>+</code></li>
<li><strong>Aesthetics</strong>: Map variables to visual properties (<code>aes()</code>)</li>
<li><strong>Geoms</strong>: Choose the right plot type for your data</li>
<li><strong>Scales</strong>: Control how data maps to visuals</li>
<li><strong>Labels</strong>: Always label axes and legends clearly (<code>labs()</code>)</li>
<li><strong>Themes</strong>: Customize appearance for publication</li>
<li><strong>Save</strong>: Use <code>ggsave()</code> with appropriate format and resolution</li>
</ol>
<hr>
</section>
</section>
<section id="week-5-homework-creating-publication-ready-plots" class="level2" data-number="5.16">
<h2 data-number="5.16" class="anchored" data-anchor-id="week-5-homework-creating-publication-ready-plots"><span class="header-section-number">5.16</span> Week 5 Homework: Creating Publication-Ready Plots</h2>
<section id="assignment-overview" class="level3" data-number="5.16.1">
<h3 data-number="5.16.1" class="anchored" data-anchor-id="assignment-overview"><span class="header-section-number">5.16.1</span> Assignment Overview</h3>
<p>You will create <strong>5 different types of plots</strong> from a provided dataset and present them in a professional Quarto report. Focus on choosing appropriate plot types, applying proper labels, and using themes effectively.</p>
</section>
<section id="dataset" class="level3" data-number="5.16.2">
<h3 data-number="5.16.2" class="anchored" data-anchor-id="dataset"><span class="header-section-number">5.16.2</span> Dataset</h3>
<p>You’ll use simulated data from a sheep grazing study:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate dataset (include this in your homework)</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2024</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>sheep_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sheep_id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">60</span>, <span class="at">each =</span> <span class="dv">4</span>),</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">breed =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Merino"</span>, <span class="st">"Suffolk"</span>, <span class="st">"Dorper"</span>), <span class="at">each =</span> <span class="dv">20</span>), <span class="at">each =</span> <span class="dv">4</span>),</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pasture_type =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Native"</span>, <span class="st">"Improved"</span>), <span class="at">each =</span> <span class="dv">30</span>), <span class="at">each =</span> <span class="dv">4</span>),</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">week =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">12</span>), <span class="at">times =</span> <span class="dv">60</span>),</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight_kg =</span> <span class="fu">rep</span>(<span class="fu">rnorm</span>(<span class="dv">60</span>, <span class="at">mean =</span> <span class="dv">45</span>, <span class="at">sd =</span> <span class="dv">5</span>), <span class="at">each =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">12</span>), <span class="at">times =</span> <span class="dv">60</span>) <span class="sc">+</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">240</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">1.5</span>),</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">wool_growth_mm =</span> <span class="fu">rep</span>(<span class="fu">rnorm</span>(<span class="dv">60</span>, <span class="at">mean =</span> <span class="dv">8</span>, <span class="at">sd =</span> <span class="fl">1.5</span>), <span class="at">each =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">rnorm</span>(<span class="dv">240</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Add some additional variables</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>sheep_data <span class="ot">&lt;-</span> sheep_data <span class="sc">%&gt;%</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sheep_id) <span class="sc">%&gt;%</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight_gain_kg =</span> weight_kg <span class="sc">-</span> <span class="fu">first</span>(weight_kg),</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_daily_gain_g =</span> (weight_gain_kg <span class="sc">*</span> <span class="dv">1000</span>) <span class="sc">/</span> (week <span class="sc">*</span> <span class="dv">7</span>)</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(week <span class="sc">&gt;</span> <span class="dv">0</span>)  <span class="co"># Remove week 0 for some analyses</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="part-1-scatter-plot-20-points" class="level3" data-number="5.16.3">
<h3 data-number="5.16.3" class="anchored" data-anchor-id="part-1-scatter-plot-20-points"><span class="header-section-number">5.16.3</span> Part 1: Scatter Plot (20 points)</h3>
<p>Create a scatter plot showing the relationship between <code>weight_kg</code> (x-axis) and <code>wool_growth_mm</code> (y-axis).</p>
<p><strong>Requirements</strong>: - Color points by <code>breed</code> - Set point size to 3 - Use <code>theme_minimal()</code> - Add appropriate title and axis labels - Include a subtitle indicating sample size</p>
<p><strong>Bonus</strong> (+5 points): Add a trend line using <code>geom_smooth(method = "lm")</code> for each breed</p>
</section>
<section id="part-2-line-plot-20-points" class="level3" data-number="5.16.4">
<h3 data-number="5.16.4" class="anchored" data-anchor-id="part-2-line-plot-20-points"><span class="header-section-number">5.16.4</span> Part 2: Line Plot (20 points)</h3>
<p>Create a line plot showing <code>weight_kg</code> over <code>week</code> for individual sheep.</p>
<p><strong>Requirements</strong>: - Show data for <strong>6 randomly selected sheep</strong> (use <code>filter(sheep_id %in% c(...))</code>) - Color lines by <code>breed</code> - Add both lines and points - Use <code>theme_classic()</code> - Proper labels and title</p>
</section>
<section id="part-3-bar-chart-20-points" class="level3" data-number="5.16.5">
<h3 data-number="5.16.5" class="anchored" data-anchor-id="part-3-bar-chart-20-points"><span class="header-section-number">5.16.5</span> Part 3: Bar Chart (20 points)</h3>
<p>Create a bar chart showing the <strong>average final weight</strong> (week 12) by breed and pasture type.</p>
<p><strong>Requirements</strong>: - Calculate average final weight using <code>dplyr</code> first - Use <code>geom_col()</code> with <code>position = "dodge"</code> for grouped bars - Fill bars by <code>pasture_type</code> - Add axis labels including units - Use a ColorBrewer palette</p>
</section>
<section id="part-4-histogram-15-points" class="level3" data-number="5.16.6">
<h3 data-number="5.16.6" class="anchored" data-anchor-id="part-4-histogram-15-points"><span class="header-section-number">5.16.6</span> Part 4: Histogram (15 points)</h3>
<p>Create histograms showing the distribution of <code>avg_daily_gain_g</code> for each breed.</p>
<p><strong>Requirements</strong>: - Three separate histograms (one per breed) — hint: use faceting or create 3 separate plots - Choose appropriate binwidth - Fill color should differ by breed - Use <code>theme_bw()</code> - Title should be descriptive</p>
<p><strong>Note</strong>: We’ll cover faceting (<code>facet_wrap()</code>) in the next chapter, but you can try it now or create 3 separate plots.</p>
</section>
<section id="part-5-box-plot-or-violin-plot-20-points" class="level3" data-number="5.16.7">
<h3 data-number="5.16.7" class="anchored" data-anchor-id="part-5-box-plot-or-violin-plot-20-points"><span class="header-section-number">5.16.7</span> Part 5: Box Plot or Violin Plot (20 points)</h3>
<p>Compare the distribution of <code>weight_gain_kg</code> (total gain over the study) across breeds and pasture types.</p>
<p><strong>Requirements</strong>: - Use <code>geom_boxplot()</code> OR <code>geom_violin()</code> (your choice) - X-axis: <code>breed</code>, fill by <code>pasture_type</code> - Add jittered points with transparency - Use <code>theme_light()</code> - Clear labels and legend</p>
</section>
<section id="part-6-interpretation-5-points" class="level3" data-number="5.16.8">
<h3 data-number="5.16.8" class="anchored" data-anchor-id="part-6-interpretation-5-points"><span class="header-section-number">5.16.8</span> Part 6: Interpretation (5 points)</h3>
<p>For each plot, write 2-3 sentences interpreting what the plot shows. What patterns, trends, or differences do you observe?</p>
</section>
<section id="bonus-challenge-10-points" class="level3" data-number="5.16.9">
<h3 data-number="5.16.9" class="anchored" data-anchor-id="bonus-challenge-10-points"><span class="header-section-number">5.16.9</span> Bonus Challenge (+10 points)</h3>
<p>Create a single multi-panel figure combining your scatter plot and box plot using either: - Manual arrangement (creating two separate plots) - Looking ahead: Try <code>library(patchwork)</code> and combine with <code>+</code></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example structure (you'll learn this next week!)</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>plot1 <span class="sc">+</span> plot2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="submission-requirements" class="level3" data-number="5.16.10">
<h3 data-number="5.16.10" class="anchored" data-anchor-id="submission-requirements"><span class="header-section-number">5.16.10</span> Submission Requirements</h3>
<ul>
<li>Submit a rendered Quarto HTML document</li>
<li>Include all code and output</li>
<li>All plots should be clearly labeled</li>
<li>Use professional formatting</li>
<li>Include interpretations</li>
</ul>
</section>
<section id="recommended-yaml" class="level3" data-number="5.16.11">
<h3 data-number="5.16.11" class="anchored" data-anchor-id="recommended-yaml"><span class="header-section-number">5.16.11</span> Recommended YAML</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb69"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"Week 5 Homework: Data Visualization with ggplot2"</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">author</span><span class="kw">:</span><span class="at"> </span><span class="st">"Your Name"</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span><span class="kw">:</span><span class="at"> today</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span><span class="kw">:</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">html</span><span class="kw">:</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc-depth</span><span class="kw">:</span><span class="at"> </span><span class="dv">2</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">code-fold</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">theme</span><span class="kw">:</span><span class="at"> cosmo</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">embed-resources</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="fu">execute</span><span class="kw">:</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">warning</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">message</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="grading-rubric" class="level3" data-number="5.16.12">
<h3 data-number="5.16.12" class="anchored" data-anchor-id="grading-rubric"><span class="header-section-number">5.16.12</span> Grading Rubric</h3>
<ul>
<li><strong>Part 1: Scatter Plot (20%)</strong>
<ul>
<li>Correct geom and aesthetics (8%)</li>
<li>Proper labels and theme (7%)</li>
<li>Overall appearance (5%)</li>
</ul></li>
<li><strong>Part 2: Line Plot (20%)</strong>
<ul>
<li>Correct data filtering and plotting (8%)</li>
<li>Lines and points shown (7%)</li>
<li>Labels and styling (5%)</li>
</ul></li>
<li><strong>Part 3: Bar Chart (20%)</strong>
<ul>
<li>Correct data summarization (8%)</li>
<li>Grouped bars correctly displayed (7%)</li>
<li>Labels and color palette (5%)</li>
</ul></li>
<li><strong>Part 4: Histogram (15%)</strong>
<ul>
<li>Appropriate binwidth chosen (6%)</li>
<li>One histogram per breed (5%)</li>
<li>Labels and theme (4%)</li>
</ul></li>
<li><strong>Part 5: Box/Violin Plot (20%)</strong>
<ul>
<li>Correct plot with multiple groupings (8%)</li>
<li>Points added with transparency (7%)</li>
<li>Labels and theme (5%)</li>
</ul></li>
<li><strong>Part 6: Interpretation (5%)</strong>
<ul>
<li>Clear, accurate interpretations for each plot</li>
</ul></li>
</ul>
<hr>
</section>
</section>
<section id="additional-resources" class="level2" data-number="5.17">
<h2 data-number="5.17" class="anchored" data-anchor-id="additional-resources"><span class="header-section-number">5.17</span> Additional Resources</h2>
<section id="required-reading" class="level3" data-number="5.17.1">
<h3 data-number="5.17.1" class="anchored" data-anchor-id="required-reading"><span class="header-section-number">5.17.1</span> Required Reading</h3>
<ul>
<li><a href="https://r4ds.hadley.nz/">R for Data Science (2e)</a> - Chapters 9-10: Visualize and Layers</li>
<li><a href="https://ggplot2.tidyverse.org/">ggplot2 documentation</a></li>
<li><a href="https://ggplot2-book.org/">ggplot2 book (3e)</a> - Chapters 1-4</li>
</ul>
</section>
<section id="optional-reading" class="level3" data-number="5.17.2">
<h3 data-number="5.17.2" class="anchored" data-anchor-id="optional-reading"><span class="header-section-number">5.17.2</span> Optional Reading</h3>
<ul>
<li>Wilkinson, L. (2005). <em>The Grammar of Graphics</em> (2nd ed.). Springer. (Original theory)</li>
<li>Wickham, H. (2010). “A Layered Grammar of Graphics.” <em>Journal of Computational and Graphical Statistics</em>, 19(1), 3-28.</li>
<li><a href="https://socviz.co/">Data Visualization: A Practical Introduction</a> by Kieran Healy</li>
</ul>
</section>
<section id="videos" class="level3" data-number="5.17.3">
<h3 data-number="5.17.3" class="anchored" data-anchor-id="videos"><span class="header-section-number">5.17.3</span> Videos</h3>
<ul>
<li>“ggplot2 Workshop” by Thomas Lin Pedersen (RStudio)</li>
<li>“A Quick Introduction to ggplot2” by StatQuest with Josh Starmer</li>
<li>“ggplot2 Tutorial” series by Data Science Dojo</li>
</ul>
</section>
<section id="cheat-sheets" class="level3" data-number="5.17.4">
<h3 data-number="5.17.4" class="anchored" data-anchor-id="cheat-sheets"><span class="header-section-number">5.17.4</span> Cheat Sheets</h3>
<ul>
<li><a href="https://rstudio.github.io/cheatsheets/data-visualization.pdf">ggplot2 Cheat Sheet</a> ⭐ <strong>Most important!</strong></li>
<li><a href="https://posit.co/resources/cheatsheets/">RStudio Cheatsheets Collection</a></li>
</ul>
</section>
<section id="galleries-and-inspiration" class="level3" data-number="5.17.5">
<h3 data-number="5.17.5" class="anchored" data-anchor-id="galleries-and-inspiration"><span class="header-section-number">5.17.5</span> Galleries and Inspiration</h3>
<ul>
<li><a href="https://r-graph-gallery.com/">R Graph Gallery</a> — Hundreds of examples with code</li>
<li><a href="http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html">Top 50 ggplot2 Visualizations</a></li>
<li><a href="https://exts.ggplot2.tidyverse.org/">ggplot2 extensions</a> — Additional packages</li>
</ul>
</section>
<section id="color-resources" class="level3" data-number="5.17.6">
<h3 data-number="5.17.6" class="anchored" data-anchor-id="color-resources"><span class="header-section-number">5.17.6</span> Color Resources</h3>
<ul>
<li><a href="https://colorbrewer2.org/">ColorBrewer</a> — Color schemes for maps and data viz</li>
<li><a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html">Viridis color palettes</a> — Colorblind-friendly</li>
<li><a href="https://coolors.co/">Coolors</a> — Color palette generator</li>
</ul>
</section>
<section id="interactive-learning" class="level3" data-number="5.17.7">
<h3 data-number="5.17.7" class="anchored" data-anchor-id="interactive-learning"><span class="header-section-number">5.17.7</span> Interactive Learning</h3>
<ul>
<li><a href="https://posit.cloud/learn/primers/3">RStudio Primers: Visualize Data</a></li>
<li><a href="https://r-graphics.org/exercises.html">ggplot2 Exercises</a></li>
</ul>
</section>
<section id="useful-websites" class="level3" data-number="5.17.8">
<h3 data-number="5.17.8" class="anchored" data-anchor-id="useful-websites"><span class="header-section-number">5.17.8</span> Useful Websites</h3>
<ul>
<li><a href="https://ggplot2.tidyverse.org/">ggplot2 Tidyverse Page</a></li>
<li><a href="https://stackoverflow.com/questions/tagged/ggplot2">Stack Overflow: ggplot2 tag</a></li>
<li><a href="https://community.rstudio.com/">RStudio Community</a></li>
</ul>
<hr>
<p><strong>Next Chapter</strong>: <a href="../chapters/ch06-ggplot2_advanced.html">Advanced ggplot2 and Multi-Panel Plots</a></p>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/ch04-dplyr.html" class="pagination-link" aria-label="Data Manipulation with dplyr">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Manipulation with dplyr</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/ch06-ggplot2_advanced.html" class="pagination-link" aria-label="Advanced ggplot2 and Multi-Panel Plots">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Advanced ggplot2 and Multi-Panel Plots</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb70" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction to Data Visualization with ggplot2</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Learning Objectives</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>By the end of this chapter, you will be able to:</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Understand the Grammar of Graphics philosophy and how ggplot2 implements it</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Create scatter plots, line plots, bar charts, histograms, box plots, and violin plots</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Map variables to aesthetic properties (color, size, shape, alpha)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Apply and customize themes for publication-ready plots</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Add labels, titles, and customize scales</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Save plots with <span class="in">`ggsave()`</span> for different output formats</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Choose the appropriate plot type for your data and research question</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction to the Grammar of Graphics</span></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a><span class="fu">### What is ggplot2?</span></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot2`</span> is R's most powerful and popular data visualization package. Created by Hadley Wickham, it implements Leland Wilkinson's **Grammar of Graphics** — a systematic way to describe and build any visualization.</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## Why "gg"plot2?</span></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**gg** = Grammar of Graphics</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**2** = Second iteration (there was a ggplot1, but it's obsolete)</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>The package is part of the tidyverse and integrates seamlessly with dplyr, tidyr, and other tidyverse tools.</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Grammar of Graphics Philosophy</span></span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a>Traditional plotting systems (like base R graphics) force you to choose from predefined plot types. The Grammar of Graphics takes a different approach: **every visualization is built by combining independent components**.</span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb70-39"><a href="#cb70-39" aria-hidden="true" tabindex="-1"></a>flowchart LR</span>
<span id="cb70-40"><a href="#cb70-40" aria-hidden="true" tabindex="-1"></a>    A[Data] --&gt; B[Aesthetic Mappings]</span>
<span id="cb70-41"><a href="#cb70-41" aria-hidden="true" tabindex="-1"></a>    B --&gt; C[Geometric Objects]</span>
<span id="cb70-42"><a href="#cb70-42" aria-hidden="true" tabindex="-1"></a>    C --&gt; D[Statistical Transformations]</span>
<span id="cb70-43"><a href="#cb70-43" aria-hidden="true" tabindex="-1"></a>    D --&gt; E[Scales]</span>
<span id="cb70-44"><a href="#cb70-44" aria-hidden="true" tabindex="-1"></a>    E --&gt; F[Coordinate System]</span>
<span id="cb70-45"><a href="#cb70-45" aria-hidden="true" tabindex="-1"></a>    F --&gt; G[Facets]</span>
<span id="cb70-46"><a href="#cb70-46" aria-hidden="true" tabindex="-1"></a>    G --&gt; H[Theme]</span>
<span id="cb70-47"><a href="#cb70-47" aria-hidden="true" tabindex="-1"></a>    H --&gt; I[Final Plot]</span>
<span id="cb70-48"><a href="#cb70-48" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-49"><a href="#cb70-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-50"><a href="#cb70-50" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Three Essential Components</span></span>
<span id="cb70-51"><a href="#cb70-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-52"><a href="#cb70-52" aria-hidden="true" tabindex="-1"></a>Every ggplot2 plot requires three components:</span>
<span id="cb70-53"><a href="#cb70-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-54"><a href="#cb70-54" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Data**: A data frame or tibble</span>
<span id="cb70-55"><a href="#cb70-55" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Aesthetic mappings** (<span class="in">`aes()`</span>): How variables map to visual properties (x, y, color, size, etc.)</span>
<span id="cb70-56"><a href="#cb70-56" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Geometric objects** (<span class="in">`geom_*()`</span>): The type of plot (points, lines, bars, etc.)</span>
<span id="cb70-57"><a href="#cb70-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-58"><a href="#cb70-58" aria-hidden="true" tabindex="-1"></a>**Basic syntax**:</span>
<span id="cb70-59"><a href="#cb70-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-60"><a href="#cb70-60" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb70-61"><a href="#cb70-61" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="sc">&lt;</span>DATA<span class="sc">&gt;</span>) <span class="sc">+</span></span>
<span id="cb70-62"><a href="#cb70-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">&lt;</span>X_VAR<span class="sc">&gt;</span>, <span class="at">y =</span> <span class="sc">&lt;</span>Y_VAR<span class="sc">&gt;</span>) <span class="sc">+</span></span>
<span id="cb70-63"><a href="#cb70-63" aria-hidden="true" tabindex="-1"></a>  geom_<span class="sc">&lt;</span>TYPE<span class="sc">&gt;</span>()</span>
<span id="cb70-64"><a href="#cb70-64" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-65"><a href="#cb70-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-66"><a href="#cb70-66" aria-hidden="true" tabindex="-1"></a>Or more commonly:</span>
<span id="cb70-67"><a href="#cb70-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-68"><a href="#cb70-68" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb70-69"><a href="#cb70-69" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="sc">&lt;</span>DATA<span class="sc">&gt;</span>, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">&lt;</span>X_VAR<span class="sc">&gt;</span>, <span class="at">y =</span> <span class="sc">&lt;</span>Y_VAR<span class="sc">&gt;</span>)) <span class="sc">+</span></span>
<span id="cb70-70"><a href="#cb70-70" aria-hidden="true" tabindex="-1"></a>  geom_<span class="sc">&lt;</span>TYPE<span class="sc">&gt;</span>()</span>
<span id="cb70-71"><a href="#cb70-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-72"><a href="#cb70-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-73"><a href="#cb70-73" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb70-74"><a href="#cb70-74" aria-hidden="true" tabindex="-1"></a><span class="fu">## ggplot2 Uses `+`, Not `%&gt;%`</span></span>
<span id="cb70-75"><a href="#cb70-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-76"><a href="#cb70-76" aria-hidden="true" tabindex="-1"></a>Notice we use <span class="in">`+`</span> to add layers to a ggplot, NOT the pipe (<span class="in">`%&gt;%`</span> or <span class="in">`|&gt;`</span>). This is a common mistake!</span>
<span id="cb70-77"><a href="#cb70-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-78"><a href="#cb70-78" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb70-79"><a href="#cb70-79" aria-hidden="true" tabindex="-1"></a><span class="co"># CORRECT</span></span>
<span id="cb70-80"><a href="#cb70-80" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> var1, <span class="at">y =</span> var2)) <span class="sc">+</span></span>
<span id="cb70-81"><a href="#cb70-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb70-82"><a href="#cb70-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-83"><a href="#cb70-83" aria-hidden="true" tabindex="-1"></a><span class="co"># WRONG - don't use pipe!</span></span>
<span id="cb70-84"><a href="#cb70-84" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> var1, <span class="at">y =</span> var2)) <span class="sc">%&gt;%</span></span>
<span id="cb70-85"><a href="#cb70-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb70-86"><a href="#cb70-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-87"><a href="#cb70-87" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-88"><a href="#cb70-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-89"><a href="#cb70-89" aria-hidden="true" tabindex="-1"></a><span class="fu">### Setup</span></span>
<span id="cb70-90"><a href="#cb70-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-91"><a href="#cb70-91" aria-hidden="true" tabindex="-1"></a>Let's load the necessary packages:</span>
<span id="cb70-92"><a href="#cb70-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-95"><a href="#cb70-95" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-96"><a href="#cb70-96" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-97"><a href="#cb70-97" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-98"><a href="#cb70-98" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb70-99"><a href="#cb70-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-100"><a href="#cb70-100" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)  <span class="co"># Includes ggplot2, dplyr, etc.</span></span>
<span id="cb70-101"><a href="#cb70-101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-102"><a href="#cb70-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-103"><a href="#cb70-103" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb70-104"><a href="#cb70-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-105"><a href="#cb70-105" aria-hidden="true" tabindex="-1"></a><span class="fu">## Your First ggplot: Scatter Plots with `geom_point()`</span></span>
<span id="cb70-106"><a href="#cb70-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-107"><a href="#cb70-107" aria-hidden="true" tabindex="-1"></a>Scatter plots display the relationship between two continuous variables. Each observation is represented by a point.</span>
<span id="cb70-108"><a href="#cb70-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-109"><a href="#cb70-109" aria-hidden="true" tabindex="-1"></a><span class="fu">### Basic Scatter Plot</span></span>
<span id="cb70-110"><a href="#cb70-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-111"><a href="#cb70-111" aria-hidden="true" tabindex="-1"></a>Let's create example data on cattle feed intake and weight gain:</span>
<span id="cb70-112"><a href="#cb70-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-115"><a href="#cb70-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-116"><a href="#cb70-116" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-117"><a href="#cb70-117" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-118"><a href="#cb70-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-119"><a href="#cb70-119" aria-hidden="true" tabindex="-1"></a><span class="co"># Create example cattle data</span></span>
<span id="cb70-120"><a href="#cb70-120" aria-hidden="true" tabindex="-1"></a>cattle <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb70-121"><a href="#cb70-121" aria-hidden="true" tabindex="-1"></a>  <span class="at">animal_id =</span> <span class="fu">paste0</span>(<span class="st">"C"</span>, <span class="dv">1001</span><span class="sc">:</span><span class="dv">1030</span>),</span>
<span id="cb70-122"><a href="#cb70-122" aria-hidden="true" tabindex="-1"></a>  <span class="at">breed =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Holstein"</span>, <span class="st">"Jersey"</span>, <span class="st">"Angus"</span>), <span class="at">each =</span> <span class="dv">10</span>),</span>
<span id="cb70-123"><a href="#cb70-123" aria-hidden="true" tabindex="-1"></a>  <span class="at">feed_intake_kg =</span> <span class="fu">c</span>(</span>
<span id="cb70-124"><a href="#cb70-124" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">3</span>),  <span class="co"># Holstein</span></span>
<span id="cb70-125"><a href="#cb70-125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">18</span>, <span class="at">sd =</span> <span class="dv">2</span>),  <span class="co"># Jersey</span></span>
<span id="cb70-126"><a href="#cb70-126" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">22</span>, <span class="at">sd =</span> <span class="fl">2.5</span>) <span class="co"># Angus</span></span>
<span id="cb70-127"><a href="#cb70-127" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb70-128"><a href="#cb70-128" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight_gain_kg =</span> <span class="fu">c</span>(</span>
<span id="cb70-129"><a href="#cb70-129" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="fl">1.2</span>, <span class="at">sd =</span> <span class="fl">0.15</span>),  <span class="co"># Holstein</span></span>
<span id="cb70-130"><a href="#cb70-130" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="fl">0.8</span>, <span class="at">sd =</span> <span class="fl">0.12</span>),  <span class="co"># Jersey</span></span>
<span id="cb70-131"><a href="#cb70-131" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="fl">1.0</span>, <span class="at">sd =</span> <span class="fl">0.13</span>)   <span class="co"># Angus</span></span>
<span id="cb70-132"><a href="#cb70-132" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-133"><a href="#cb70-133" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-134"><a href="#cb70-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-135"><a href="#cb70-135" aria-hidden="true" tabindex="-1"></a><span class="co"># View first few rows</span></span>
<span id="cb70-136"><a href="#cb70-136" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cattle)</span>
<span id="cb70-137"><a href="#cb70-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-138"><a href="#cb70-138" aria-hidden="true" tabindex="-1"></a><span class="co"># Create basic scatter plot</span></span>
<span id="cb70-139"><a href="#cb70-139" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg)) <span class="sc">+</span></span>
<span id="cb70-140"><a href="#cb70-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb70-141"><a href="#cb70-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-142"><a href="#cb70-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-143"><a href="#cb70-143" aria-hidden="true" tabindex="-1"></a>**Reading this code:**</span>
<span id="cb70-144"><a href="#cb70-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-145"><a href="#cb70-145" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`ggplot(cattle, ...)`</span> — Use the cattle data</span>
<span id="cb70-146"><a href="#cb70-146" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span><span class="in">`aes(x = feed_intake_kg, y = weight_gain_kg)`</span> — Map feed intake to x-axis, weight gain to y-axis</span>
<span id="cb70-147"><a href="#cb70-147" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span><span class="in">`geom_point()`</span> — Draw points</span>
<span id="cb70-148"><a href="#cb70-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-149"><a href="#cb70-149" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adding Color by Group</span></span>
<span id="cb70-150"><a href="#cb70-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-151"><a href="#cb70-151" aria-hidden="true" tabindex="-1"></a>We can map the <span class="in">`breed`</span> variable to color:</span>
<span id="cb70-152"><a href="#cb70-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-155"><a href="#cb70-155" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-156"><a href="#cb70-156" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-157"><a href="#cb70-157" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-158"><a href="#cb70-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-159"><a href="#cb70-159" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg, <span class="at">color =</span> breed)) <span class="sc">+</span></span>
<span id="cb70-160"><a href="#cb70-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb70-161"><a href="#cb70-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-162"><a href="#cb70-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-163"><a href="#cb70-163" aria-hidden="true" tabindex="-1"></a>Notice:</span>
<span id="cb70-164"><a href="#cb70-164" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Each breed gets a different color automatically</span>
<span id="cb70-165"><a href="#cb70-165" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A legend is created automatically</span>
<span id="cb70-166"><a href="#cb70-166" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Colors are chosen from a default palette</span>
<span id="cb70-167"><a href="#cb70-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-168"><a href="#cb70-168" aria-hidden="true" tabindex="-1"></a><span class="fu">### Customizing Point Aesthetics</span></span>
<span id="cb70-169"><a href="#cb70-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-170"><a href="#cb70-170" aria-hidden="true" tabindex="-1"></a>Points have several aesthetic properties we can map to variables OR set manually:</span>
<span id="cb70-171"><a href="#cb70-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-172"><a href="#cb70-172" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Aesthetic <span class="pp">|</span> What it controls <span class="pp">|</span> Example variable type <span class="pp">|</span></span>
<span id="cb70-173"><a href="#cb70-173" aria-hidden="true" tabindex="-1"></a><span class="pp">|-----------|------------------|-----------------------|</span></span>
<span id="cb70-174"><a href="#cb70-174" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`x`</span> <span class="pp">|</span> Horizontal position <span class="pp">|</span> Continuous <span class="pp">|</span></span>
<span id="cb70-175"><a href="#cb70-175" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`y`</span> <span class="pp">|</span> Vertical position <span class="pp">|</span> Continuous <span class="pp">|</span></span>
<span id="cb70-176"><a href="#cb70-176" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`color`</span> <span class="pp">|</span> Point outline color <span class="pp">|</span> Categorical or continuous <span class="pp">|</span></span>
<span id="cb70-177"><a href="#cb70-177" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`size`</span> <span class="pp">|</span> Point size <span class="pp">|</span> Continuous <span class="pp">|</span></span>
<span id="cb70-178"><a href="#cb70-178" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`shape`</span> <span class="pp">|</span> Point shape <span class="pp">|</span> Categorical <span class="pp">|</span></span>
<span id="cb70-179"><a href="#cb70-179" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`alpha`</span> <span class="pp">|</span> Transparency (0-1) <span class="pp">|</span> Continuous <span class="pp">|</span></span>
<span id="cb70-180"><a href="#cb70-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-181"><a href="#cb70-181" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb70-182"><a href="#cb70-182" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mapping vs Setting</span></span>
<span id="cb70-183"><a href="#cb70-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-184"><a href="#cb70-184" aria-hidden="true" tabindex="-1"></a>**Mapping** (inside <span class="in">`aes()`</span>): Connects a variable to an aesthetic — varies by data</span>
<span id="cb70-185"><a href="#cb70-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-186"><a href="#cb70-186" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb70-187"><a href="#cb70-187" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">color =</span> breed)  <span class="co"># Color depends on breed variable</span></span>
<span id="cb70-188"><a href="#cb70-188" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-189"><a href="#cb70-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-190"><a href="#cb70-190" aria-hidden="true" tabindex="-1"></a>**Setting** (outside <span class="in">`aes()`</span>): Sets a fixed value for all points</span>
<span id="cb70-191"><a href="#cb70-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-192"><a href="#cb70-192" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb70-193"><a href="#cb70-193" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>)  <span class="co"># All points blue and size 3</span></span>
<span id="cb70-194"><a href="#cb70-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-195"><a href="#cb70-195" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-196"><a href="#cb70-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-197"><a href="#cb70-197" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example: Mapping Size</span></span>
<span id="cb70-198"><a href="#cb70-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-201"><a href="#cb70-201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-202"><a href="#cb70-202" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-203"><a href="#cb70-203" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-204"><a href="#cb70-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-205"><a href="#cb70-205" aria-hidden="true" tabindex="-1"></a><span class="co"># Map size to feed intake (redundant with x, but demonstrates the concept)</span></span>
<span id="cb70-206"><a href="#cb70-206" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg,</span>
<span id="cb70-207"><a href="#cb70-207" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> breed, <span class="at">size =</span> feed_intake_kg)) <span class="sc">+</span></span>
<span id="cb70-208"><a href="#cb70-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb70-209"><a href="#cb70-209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-210"><a href="#cb70-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-211"><a href="#cb70-211" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example: Setting Fixed Aesthetics</span></span>
<span id="cb70-212"><a href="#cb70-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-215"><a href="#cb70-215" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-216"><a href="#cb70-216" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-217"><a href="#cb70-217" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-218"><a href="#cb70-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-219"><a href="#cb70-219" aria-hidden="true" tabindex="-1"></a><span class="co"># Make all points larger and semi-transparent</span></span>
<span id="cb70-220"><a href="#cb70-220" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg, <span class="at">color =</span> breed)) <span class="sc">+</span></span>
<span id="cb70-221"><a href="#cb70-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>)</span>
<span id="cb70-222"><a href="#cb70-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-223"><a href="#cb70-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-224"><a href="#cb70-224" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example: Using Shape</span></span>
<span id="cb70-225"><a href="#cb70-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-228"><a href="#cb70-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-229"><a href="#cb70-229" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-230"><a href="#cb70-230" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-231"><a href="#cb70-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-232"><a href="#cb70-232" aria-hidden="true" tabindex="-1"></a><span class="co"># Map shape to breed (in addition to color)</span></span>
<span id="cb70-233"><a href="#cb70-233" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg,</span>
<span id="cb70-234"><a href="#cb70-234" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> breed, <span class="at">shape =</span> breed)) <span class="sc">+</span></span>
<span id="cb70-235"><a href="#cb70-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb70-236"><a href="#cb70-236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-237"><a href="#cb70-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-238"><a href="#cb70-238" aria-hidden="true" tabindex="-1"></a><span class="fu">### When to Use Scatter Plots</span></span>
<span id="cb70-239"><a href="#cb70-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-240"><a href="#cb70-240" aria-hidden="true" tabindex="-1"></a>✅ **Use scatter plots when:**</span>
<span id="cb70-241"><a href="#cb70-241" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You have two continuous variables</span>
<span id="cb70-242"><a href="#cb70-242" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You want to explore relationships/correlations</span>
<span id="cb70-243"><a href="#cb70-243" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You want to identify outliers or patterns</span>
<span id="cb70-244"><a href="#cb70-244" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You want to show individual data points</span>
<span id="cb70-245"><a href="#cb70-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-246"><a href="#cb70-246" aria-hidden="true" tabindex="-1"></a>❌ **Don't use scatter plots when:**</span>
<span id="cb70-247"><a href="#cb70-247" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>One or both variables are categorical (use bar charts or box plots)</span>
<span id="cb70-248"><a href="#cb70-248" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You have too many overlapping points (consider hex bins or contour plots)</span>
<span id="cb70-249"><a href="#cb70-249" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You want to show change over time for a single entity (use line plots)</span>
<span id="cb70-250"><a href="#cb70-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-251"><a href="#cb70-251" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb70-252"><a href="#cb70-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-253"><a href="#cb70-253" aria-hidden="true" tabindex="-1"></a><span class="fu">## Line Plots with `geom_line()`</span></span>
<span id="cb70-254"><a href="#cb70-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-255"><a href="#cb70-255" aria-hidden="true" tabindex="-1"></a>Line plots connect points in order, typically used for time series or sequential data.</span>
<span id="cb70-256"><a href="#cb70-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-257"><a href="#cb70-257" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Growth Curves</span></span>
<span id="cb70-258"><a href="#cb70-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-261"><a href="#cb70-261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-262"><a href="#cb70-262" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-263"><a href="#cb70-263" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-264"><a href="#cb70-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-265"><a href="#cb70-265" aria-hidden="true" tabindex="-1"></a><span class="co"># Create growth data for individual animals over time</span></span>
<span id="cb70-266"><a href="#cb70-266" aria-hidden="true" tabindex="-1"></a>growth <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb70-267"><a href="#cb70-267" aria-hidden="true" tabindex="-1"></a>  <span class="at">animal_id =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"H001"</span>, <span class="st">"H002"</span>, <span class="st">"H003"</span>), <span class="at">each =</span> <span class="dv">6</span>),</span>
<span id="cb70-268"><a href="#cb70-268" aria-hidden="true" tabindex="-1"></a>  <span class="at">week =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>), <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb70-269"><a href="#cb70-269" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight_kg =</span> <span class="fu">c</span>(</span>
<span id="cb70-270"><a href="#cb70-270" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">58</span>, <span class="dv">72</span>, <span class="dv">88</span>, <span class="dv">105</span>, <span class="dv">122</span>),  <span class="co"># H001</span></span>
<span id="cb70-271"><a href="#cb70-271" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">42</span>, <span class="dv">55</span>, <span class="dv">68</span>, <span class="dv">83</span>, <span class="dv">98</span>, <span class="dv">115</span>),   <span class="co"># H002</span></span>
<span id="cb70-272"><a href="#cb70-272" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">48</span>, <span class="dv">60</span>, <span class="dv">75</span>, <span class="dv">91</span>, <span class="dv">108</span>, <span class="dv">126</span>)   <span class="co"># H003</span></span>
<span id="cb70-273"><a href="#cb70-273" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-274"><a href="#cb70-274" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-275"><a href="#cb70-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-276"><a href="#cb70-276" aria-hidden="true" tabindex="-1"></a>growth</span>
<span id="cb70-277"><a href="#cb70-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-278"><a href="#cb70-278" aria-hidden="true" tabindex="-1"></a><span class="co"># Create line plot</span></span>
<span id="cb70-279"><a href="#cb70-279" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(growth, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> weight_kg, <span class="at">color =</span> animal_id)) <span class="sc">+</span></span>
<span id="cb70-280"><a href="#cb70-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb70-281"><a href="#cb70-281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-282"><a href="#cb70-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-283"><a href="#cb70-283" aria-hidden="true" tabindex="-1"></a><span class="fu">### Combining Lines and Points</span></span>
<span id="cb70-284"><a href="#cb70-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-285"><a href="#cb70-285" aria-hidden="true" tabindex="-1"></a>Often, it's helpful to show both the line and the data points:</span>
<span id="cb70-286"><a href="#cb70-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-289"><a href="#cb70-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-290"><a href="#cb70-290" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-291"><a href="#cb70-291" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-292"><a href="#cb70-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-293"><a href="#cb70-293" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(growth, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> weight_kg, <span class="at">color =</span> animal_id)) <span class="sc">+</span></span>
<span id="cb70-294"><a href="#cb70-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb70-295"><a href="#cb70-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb70-296"><a href="#cb70-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-297"><a href="#cb70-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-298"><a href="#cb70-298" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb70-299"><a href="#cb70-299" aria-hidden="true" tabindex="-1"></a><span class="fu">## Layer Order Matters</span></span>
<span id="cb70-300"><a href="#cb70-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-301"><a href="#cb70-301" aria-hidden="true" tabindex="-1"></a>Layers are drawn in the order you add them. Later layers appear on top of earlier layers.</span>
<span id="cb70-302"><a href="#cb70-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-303"><a href="#cb70-303" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb70-304"><a href="#cb70-304" aria-hidden="true" tabindex="-1"></a><span class="co"># Points on top of lines (usually preferred)</span></span>
<span id="cb70-305"><a href="#cb70-305" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb70-306"><a href="#cb70-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-307"><a href="#cb70-307" aria-hidden="true" tabindex="-1"></a><span class="co"># Lines on top of points (can obscure data)</span></span>
<span id="cb70-308"><a href="#cb70-308" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>()</span>
<span id="cb70-309"><a href="#cb70-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-310"><a href="#cb70-310" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-311"><a href="#cb70-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-312"><a href="#cb70-312" aria-hidden="true" tabindex="-1"></a><span class="fu">### Customizing Lines</span></span>
<span id="cb70-313"><a href="#cb70-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-316"><a href="#cb70-316" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-317"><a href="#cb70-317" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-318"><a href="#cb70-318" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-319"><a href="#cb70-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-320"><a href="#cb70-320" aria-hidden="true" tabindex="-1"></a><span class="co"># Thicker lines with different line types</span></span>
<span id="cb70-321"><a href="#cb70-321" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(growth, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> weight_kg, <span class="at">color =</span> animal_id)) <span class="sc">+</span></span>
<span id="cb70-322"><a href="#cb70-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb70-323"><a href="#cb70-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb70-324"><a href="#cb70-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-325"><a href="#cb70-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-326"><a href="#cb70-326" aria-hidden="true" tabindex="-1"></a><span class="fu">### When to Use Line Plots</span></span>
<span id="cb70-327"><a href="#cb70-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-328"><a href="#cb70-328" aria-hidden="true" tabindex="-1"></a>✅ **Use line plots when:**</span>
<span id="cb70-329"><a href="#cb70-329" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Data represents a sequence (especially time)</span>
<span id="cb70-330"><a href="#cb70-330" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You want to show trends or changes</span>
<span id="cb70-331"><a href="#cb70-331" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Points should be connected in a specific order</span>
<span id="cb70-332"><a href="#cb70-332" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You're tracking individual subjects over time</span>
<span id="cb70-333"><a href="#cb70-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-334"><a href="#cb70-334" aria-hidden="true" tabindex="-1"></a>❌ **Don't use line plots when:**</span>
<span id="cb70-335"><a href="#cb70-335" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Data points are independent (no meaningful order)</span>
<span id="cb70-336"><a href="#cb70-336" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You have many overlapping trajectories (hard to read)</span>
<span id="cb70-337"><a href="#cb70-337" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>X-axis is not continuous or sequential</span>
<span id="cb70-338"><a href="#cb70-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-339"><a href="#cb70-339" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb70-340"><a href="#cb70-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-341"><a href="#cb70-341" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bar Charts with `geom_col()` and `geom_bar()`</span></span>
<span id="cb70-342"><a href="#cb70-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-343"><a href="#cb70-343" aria-hidden="true" tabindex="-1"></a>Bar charts display categorical data with rectangular bars.</span>
<span id="cb70-344"><a href="#cb70-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-345"><a href="#cb70-345" aria-hidden="true" tabindex="-1"></a><span class="fu">### `geom_col()` vs `geom_bar()`</span></span>
<span id="cb70-346"><a href="#cb70-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-347"><a href="#cb70-347" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Function <span class="pp">|</span> When to use <span class="pp">|</span> Y-axis comes from <span class="pp">|</span></span>
<span id="cb70-348"><a href="#cb70-348" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------|-------------|-------------------|</span></span>
<span id="cb70-349"><a href="#cb70-349" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`geom_col()`</span> <span class="pp">|</span> You've already calculated the values <span class="pp">|</span> Your data <span class="pp">|</span></span>
<span id="cb70-350"><a href="#cb70-350" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`geom_bar()`</span> <span class="pp">|</span> You want to count occurrences <span class="pp">|</span> Automatic counting <span class="pp">|</span></span>
<span id="cb70-351"><a href="#cb70-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-352"><a href="#cb70-352" aria-hidden="true" tabindex="-1"></a><span class="fu">### Using `geom_col()` with Pre-calculated Values</span></span>
<span id="cb70-353"><a href="#cb70-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-356"><a href="#cb70-356" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-357"><a href="#cb70-357" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-358"><a href="#cb70-358" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-359"><a href="#cb70-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-360"><a href="#cb70-360" aria-hidden="true" tabindex="-1"></a><span class="co"># Average milk production by breed (already summarized)</span></span>
<span id="cb70-361"><a href="#cb70-361" aria-hidden="true" tabindex="-1"></a>milk_production <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb70-362"><a href="#cb70-362" aria-hidden="true" tabindex="-1"></a>  <span class="at">breed =</span> <span class="fu">c</span>(<span class="st">"Holstein"</span>, <span class="st">"Jersey"</span>, <span class="st">"Guernsey"</span>, <span class="st">"Brown Swiss"</span>),</span>
<span id="cb70-363"><a href="#cb70-363" aria-hidden="true" tabindex="-1"></a>  <span class="at">avg_liters_per_day =</span> <span class="fu">c</span>(<span class="dv">35</span>, <span class="dv">24</span>, <span class="dv">28</span>, <span class="dv">30</span>)</span>
<span id="cb70-364"><a href="#cb70-364" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-365"><a href="#cb70-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-366"><a href="#cb70-366" aria-hidden="true" tabindex="-1"></a>milk_production</span>
<span id="cb70-367"><a href="#cb70-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-368"><a href="#cb70-368" aria-hidden="true" tabindex="-1"></a><span class="co"># Create bar chart</span></span>
<span id="cb70-369"><a href="#cb70-369" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(milk_production, <span class="fu">aes</span>(<span class="at">x =</span> breed, <span class="at">y =</span> avg_liters_per_day)) <span class="sc">+</span></span>
<span id="cb70-370"><a href="#cb70-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span>
<span id="cb70-371"><a href="#cb70-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-372"><a href="#cb70-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-373"><a href="#cb70-373" aria-hidden="true" tabindex="-1"></a><span class="fu">### Using `geom_bar()` to Count</span></span>
<span id="cb70-374"><a href="#cb70-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-377"><a href="#cb70-377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-378"><a href="#cb70-378" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-379"><a href="#cb70-379" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-380"><a href="#cb70-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-381"><a href="#cb70-381" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset with individual animals</span></span>
<span id="cb70-382"><a href="#cb70-382" aria-hidden="true" tabindex="-1"></a>animals <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb70-383"><a href="#cb70-383" aria-hidden="true" tabindex="-1"></a>  <span class="at">breed =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Holstein"</span>, <span class="st">"Jersey"</span>, <span class="st">"Angus"</span>), <span class="at">size =</span> <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb70-384"><a href="#cb70-384" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-385"><a href="#cb70-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-386"><a href="#cb70-386" aria-hidden="true" tabindex="-1"></a><span class="co"># Count animals per breed automatically</span></span>
<span id="cb70-387"><a href="#cb70-387" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(animals, <span class="fu">aes</span>(<span class="at">x =</span> breed)) <span class="sc">+</span></span>
<span id="cb70-388"><a href="#cb70-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span>
<span id="cb70-389"><a href="#cb70-389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-390"><a href="#cb70-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-391"><a href="#cb70-391" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb70-392"><a href="#cb70-392" aria-hidden="true" tabindex="-1"></a><span class="fu">## `geom_bar()` Counts for You</span></span>
<span id="cb70-393"><a href="#cb70-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-394"><a href="#cb70-394" aria-hidden="true" tabindex="-1"></a>When you use <span class="in">`geom_bar()`</span>, you only specify <span class="in">`x`</span> (the categorical variable). The y-axis (count) is calculated automatically using <span class="in">`stat = "count"`</span>.</span>
<span id="cb70-395"><a href="#cb70-395" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-396"><a href="#cb70-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-397"><a href="#cb70-397" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adding Color</span></span>
<span id="cb70-398"><a href="#cb70-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-401"><a href="#cb70-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-402"><a href="#cb70-402" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-403"><a href="#cb70-403" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-404"><a href="#cb70-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-405"><a href="#cb70-405" aria-hidden="true" tabindex="-1"></a><span class="co"># Color bars by breed</span></span>
<span id="cb70-406"><a href="#cb70-406" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(milk_production, <span class="fu">aes</span>(<span class="at">x =</span> breed, <span class="at">y =</span> avg_liters_per_day, <span class="at">fill =</span> breed)) <span class="sc">+</span></span>
<span id="cb70-407"><a href="#cb70-407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span>
<span id="cb70-408"><a href="#cb70-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-409"><a href="#cb70-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-410"><a href="#cb70-410" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb70-411"><a href="#cb70-411" aria-hidden="true" tabindex="-1"></a><span class="fu">## `color` vs `fill` for Bars</span></span>
<span id="cb70-412"><a href="#cb70-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-413"><a href="#cb70-413" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`color`</span> controls the **outline** of the bar</span>
<span id="cb70-414"><a href="#cb70-414" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`fill`</span> controls the **inside** of the bar</span>
<span id="cb70-415"><a href="#cb70-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-416"><a href="#cb70-416" aria-hidden="true" tabindex="-1"></a>Usually, you want <span class="in">`fill`</span> for bar charts:</span>
<span id="cb70-417"><a href="#cb70-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-418"><a href="#cb70-418" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb70-419"><a href="#cb70-419" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">fill =</span> breed)  <span class="co"># Fills the bars (typical)</span></span>
<span id="cb70-420"><a href="#cb70-420" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">color =</span> breed) <span class="co"># Just colors the outlines (usually not what you want)</span></span>
<span id="cb70-421"><a href="#cb70-421" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-422"><a href="#cb70-422" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-423"><a href="#cb70-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-424"><a href="#cb70-424" aria-hidden="true" tabindex="-1"></a><span class="fu">### Grouped and Stacked Bars</span></span>
<span id="cb70-425"><a href="#cb70-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-428"><a href="#cb70-428" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-429"><a href="#cb70-429" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-430"><a href="#cb70-430" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-431"><a href="#cb70-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-432"><a href="#cb70-432" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data with two categorical variables</span></span>
<span id="cb70-433"><a href="#cb70-433" aria-hidden="true" tabindex="-1"></a>feed_trial <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb70-434"><a href="#cb70-434" aria-hidden="true" tabindex="-1"></a>  <span class="at">breed =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Holstein"</span>, <span class="st">"Jersey"</span>), <span class="at">each =</span> <span class="dv">3</span>),</span>
<span id="cb70-435"><a href="#cb70-435" aria-hidden="true" tabindex="-1"></a>  <span class="at">feed_type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">times =</span> <span class="dv">2</span>),</span>
<span id="cb70-436"><a href="#cb70-436" aria-hidden="true" tabindex="-1"></a>  <span class="at">avg_gain_kg =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">1.4</span>, <span class="fl">1.1</span>, <span class="fl">0.9</span>, <span class="fl">1.0</span>, <span class="fl">0.8</span>)</span>
<span id="cb70-437"><a href="#cb70-437" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-438"><a href="#cb70-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-439"><a href="#cb70-439" aria-hidden="true" tabindex="-1"></a>feed_trial</span>
<span id="cb70-440"><a href="#cb70-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-441"><a href="#cb70-441" aria-hidden="true" tabindex="-1"></a><span class="co"># Grouped bars</span></span>
<span id="cb70-442"><a href="#cb70-442" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(feed_trial, <span class="fu">aes</span>(<span class="at">x =</span> breed, <span class="at">y =</span> avg_gain_kg, <span class="at">fill =</span> feed_type)) <span class="sc">+</span></span>
<span id="cb70-443"><a href="#cb70-443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>)</span>
<span id="cb70-444"><a href="#cb70-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-445"><a href="#cb70-445" aria-hidden="true" tabindex="-1"></a><span class="co"># Stacked bars (default)</span></span>
<span id="cb70-446"><a href="#cb70-446" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(feed_trial, <span class="fu">aes</span>(<span class="at">x =</span> breed, <span class="at">y =</span> avg_gain_kg, <span class="at">fill =</span> feed_type)) <span class="sc">+</span></span>
<span id="cb70-447"><a href="#cb70-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span>
<span id="cb70-448"><a href="#cb70-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-449"><a href="#cb70-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-450"><a href="#cb70-450" aria-hidden="true" tabindex="-1"></a><span class="fu">### Horizontal Bars</span></span>
<span id="cb70-451"><a href="#cb70-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-454"><a href="#cb70-454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-455"><a href="#cb70-455" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-456"><a href="#cb70-456" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-457"><a href="#cb70-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-458"><a href="#cb70-458" aria-hidden="true" tabindex="-1"></a><span class="co"># Use coord_flip() for horizontal bars</span></span>
<span id="cb70-459"><a href="#cb70-459" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(milk_production, <span class="fu">aes</span>(<span class="at">x =</span> breed, <span class="at">y =</span> avg_liters_per_day)) <span class="sc">+</span></span>
<span id="cb70-460"><a href="#cb70-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb70-461"><a href="#cb70-461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb70-462"><a href="#cb70-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-463"><a href="#cb70-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-464"><a href="#cb70-464" aria-hidden="true" tabindex="-1"></a><span class="fu">### When to Use Bar Charts</span></span>
<span id="cb70-465"><a href="#cb70-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-466"><a href="#cb70-466" aria-hidden="true" tabindex="-1"></a>✅ **Use bar charts when:**</span>
<span id="cb70-467"><a href="#cb70-467" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Comparing quantities across categories</span>
<span id="cb70-468"><a href="#cb70-468" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Showing counts or frequencies</span>
<span id="cb70-469"><a href="#cb70-469" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Categories are on the x-axis</span>
<span id="cb70-470"><a href="#cb70-470" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Bars should start at zero</span>
<span id="cb70-471"><a href="#cb70-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-472"><a href="#cb70-472" aria-hidden="true" tabindex="-1"></a>❌ **Don't use bar charts when:**</span>
<span id="cb70-473"><a href="#cb70-473" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Showing distributions (use histograms)</span>
<span id="cb70-474"><a href="#cb70-474" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Comparing many categories (can be hard to read)</span>
<span id="cb70-475"><a href="#cb70-475" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Changes over time are important (use line plots)</span>
<span id="cb70-476"><a href="#cb70-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-477"><a href="#cb70-477" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb70-478"><a href="#cb70-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-479"><a href="#cb70-479" aria-hidden="true" tabindex="-1"></a><span class="fu">## Histograms with `geom_histogram()`</span></span>
<span id="cb70-480"><a href="#cb70-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-481"><a href="#cb70-481" aria-hidden="true" tabindex="-1"></a>Histograms show the **distribution** of a single continuous variable by dividing the data into bins and counting how many observations fall into each bin.</span>
<span id="cb70-482"><a href="#cb70-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-483"><a href="#cb70-483" aria-hidden="true" tabindex="-1"></a><span class="fu">### Basic Histogram</span></span>
<span id="cb70-484"><a href="#cb70-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-487"><a href="#cb70-487" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-488"><a href="#cb70-488" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-489"><a href="#cb70-489" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-490"><a href="#cb70-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-491"><a href="#cb70-491" aria-hidden="true" tabindex="-1"></a><span class="co"># Create birth weight data</span></span>
<span id="cb70-492"><a href="#cb70-492" aria-hidden="true" tabindex="-1"></a>birth_weights <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb70-493"><a href="#cb70-493" aria-hidden="true" tabindex="-1"></a>  <span class="at">calf_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>,</span>
<span id="cb70-494"><a href="#cb70-494" aria-hidden="true" tabindex="-1"></a>  <span class="at">birth_weight_kg =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="at">mean =</span> <span class="dv">40</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb70-495"><a href="#cb70-495" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-496"><a href="#cb70-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-497"><a href="#cb70-497" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram</span></span>
<span id="cb70-498"><a href="#cb70-498" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birth_weights, <span class="fu">aes</span>(<span class="at">x =</span> birth_weight_kg)) <span class="sc">+</span></span>
<span id="cb70-499"><a href="#cb70-499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span>
<span id="cb70-500"><a href="#cb70-500" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-501"><a href="#cb70-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-502"><a href="#cb70-502" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb70-503"><a href="#cb70-503" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pick the Right Number of Bins!</span></span>
<span id="cb70-504"><a href="#cb70-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-505"><a href="#cb70-505" aria-hidden="true" tabindex="-1"></a>The default number of bins (30) may not be ideal for your data. Experiment with:</span>
<span id="cb70-506"><a href="#cb70-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-507"><a href="#cb70-507" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb70-508"><a href="#cb70-508" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>)      <span class="co"># Specify number of bins</span></span>
<span id="cb70-509"><a href="#cb70-509" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>)   <span class="co"># Specify width of each bin</span></span>
<span id="cb70-510"><a href="#cb70-510" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-511"><a href="#cb70-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-512"><a href="#cb70-512" aria-hidden="true" tabindex="-1"></a>Too few bins → lose detail; too many bins → noisy</span>
<span id="cb70-513"><a href="#cb70-513" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-514"><a href="#cb70-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-515"><a href="#cb70-515" aria-hidden="true" tabindex="-1"></a><span class="fu">### Customizing Binwidth</span></span>
<span id="cb70-516"><a href="#cb70-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-519"><a href="#cb70-519" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-520"><a href="#cb70-520" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-521"><a href="#cb70-521" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-522"><a href="#cb70-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-523"><a href="#cb70-523" aria-hidden="true" tabindex="-1"></a><span class="co"># Wider bins (3 kg)</span></span>
<span id="cb70-524"><a href="#cb70-524" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birth_weights, <span class="fu">aes</span>(<span class="at">x =</span> birth_weight_kg)) <span class="sc">+</span></span>
<span id="cb70-525"><a href="#cb70-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>)</span>
<span id="cb70-526"><a href="#cb70-526" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-527"><a href="#cb70-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-528"><a href="#cb70-528" aria-hidden="true" tabindex="-1"></a><span class="fu">### Overlapping Histograms by Group</span></span>
<span id="cb70-529"><a href="#cb70-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-532"><a href="#cb70-532" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-533"><a href="#cb70-533" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-534"><a href="#cb70-534" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-535"><a href="#cb70-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-536"><a href="#cb70-536" aria-hidden="true" tabindex="-1"></a><span class="co"># Create breed data with different distributions</span></span>
<span id="cb70-537"><a href="#cb70-537" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb70-538"><a href="#cb70-538" aria-hidden="true" tabindex="-1"></a>breeds_vec <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Holstein"</span>, <span class="st">"Jersey"</span>), <span class="at">size =</span> <span class="dv">200</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb70-539"><a href="#cb70-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-540"><a href="#cb70-540" aria-hidden="true" tabindex="-1"></a>birth_weights_breed <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb70-541"><a href="#cb70-541" aria-hidden="true" tabindex="-1"></a>  <span class="at">breed =</span> breeds_vec,</span>
<span id="cb70-542"><a href="#cb70-542" aria-hidden="true" tabindex="-1"></a>  <span class="at">birth_weight_kg =</span> <span class="fu">ifelse</span>(</span>
<span id="cb70-543"><a href="#cb70-543" aria-hidden="true" tabindex="-1"></a>    breed <span class="sc">==</span> <span class="st">"Holstein"</span>,</span>
<span id="cb70-544"><a href="#cb70-544" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="fu">sum</span>(breed <span class="sc">==</span> <span class="st">"Holstein"</span>), <span class="at">mean =</span> <span class="dv">42</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb70-545"><a href="#cb70-545" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="fu">sum</span>(breed <span class="sc">==</span> <span class="st">"Jersey"</span>), <span class="at">mean =</span> <span class="dv">37</span>, <span class="at">sd =</span> <span class="dv">4</span>)</span>
<span id="cb70-546"><a href="#cb70-546" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-547"><a href="#cb70-547" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-548"><a href="#cb70-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-549"><a href="#cb70-549" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlapping histograms</span></span>
<span id="cb70-550"><a href="#cb70-550" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birth_weights_breed, <span class="fu">aes</span>(<span class="at">x =</span> birth_weight_kg, <span class="at">fill =</span> breed)) <span class="sc">+</span></span>
<span id="cb70-551"><a href="#cb70-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span>
<span id="cb70-552"><a href="#cb70-552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-553"><a href="#cb70-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-554"><a href="#cb70-554" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb70-555"><a href="#cb70-555" aria-hidden="true" tabindex="-1"></a><span class="fu">## Use `alpha` for Overlapping Histograms</span></span>
<span id="cb70-556"><a href="#cb70-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-557"><a href="#cb70-557" aria-hidden="true" tabindex="-1"></a>When showing multiple distributions, use <span class="in">`alpha`</span> (transparency) so you can see where they overlap:</span>
<span id="cb70-558"><a href="#cb70-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-559"><a href="#cb70-559" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb70-560"><a href="#cb70-560" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_histogram</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span>
<span id="cb70-561"><a href="#cb70-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-562"><a href="#cb70-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-563"><a href="#cb70-563" aria-hidden="true" tabindex="-1"></a><span class="in">`position = "identity"`</span> places histograms on top of each other (default is stacked).</span>
<span id="cb70-564"><a href="#cb70-564" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-565"><a href="#cb70-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-566"><a href="#cb70-566" aria-hidden="true" tabindex="-1"></a><span class="fu">### When to Use Histograms</span></span>
<span id="cb70-567"><a href="#cb70-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-568"><a href="#cb70-568" aria-hidden="true" tabindex="-1"></a>✅ **Use histograms when:**</span>
<span id="cb70-569"><a href="#cb70-569" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Showing the distribution of a continuous variable</span>
<span id="cb70-570"><a href="#cb70-570" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Checking for normality</span>
<span id="cb70-571"><a href="#cb70-571" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Identifying skewness or outliers</span>
<span id="cb70-572"><a href="#cb70-572" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Understanding the shape of your data</span>
<span id="cb70-573"><a href="#cb70-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-574"><a href="#cb70-574" aria-hidden="true" tabindex="-1"></a>❌ **Don't use histograms when:**</span>
<span id="cb70-575"><a href="#cb70-575" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You have categorical data (use bar charts)</span>
<span id="cb70-576"><a href="#cb70-576" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Comparing multiple groups precisely (use box plots or density plots)</span>
<span id="cb70-577"><a href="#cb70-577" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You have very few data points (distributions won't be clear)</span>
<span id="cb70-578"><a href="#cb70-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-579"><a href="#cb70-579" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb70-580"><a href="#cb70-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-581"><a href="#cb70-581" aria-hidden="true" tabindex="-1"></a><span class="fu">## Box Plots with `geom_boxplot()`</span></span>
<span id="cb70-582"><a href="#cb70-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-583"><a href="#cb70-583" aria-hidden="true" tabindex="-1"></a>Box plots (box-and-whisker plots) display the distribution of data through five summary statistics: minimum, first quartile (Q1), median, third quartile (Q3), and maximum.</span>
<span id="cb70-584"><a href="#cb70-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-585"><a href="#cb70-585" aria-hidden="true" tabindex="-1"></a><span class="fu">### Anatomy of a Box Plot</span></span>
<span id="cb70-586"><a href="#cb70-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-589"><a href="#cb70-589" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb70-590"><a href="#cb70-590" aria-hidden="true" tabindex="-1"></a>graph TD</span>
<span id="cb70-591"><a href="#cb70-591" aria-hidden="true" tabindex="-1"></a>    A[Box Plot Components] --&gt; B[Box: IQR Q1 to Q3]</span>
<span id="cb70-592"><a href="#cb70-592" aria-hidden="true" tabindex="-1"></a>    A --&gt; C[Line in box: Median]</span>
<span id="cb70-593"><a href="#cb70-593" aria-hidden="true" tabindex="-1"></a>    A --&gt; D[Whiskers: <span class="fl">1.5</span> × IQR]</span>
<span id="cb70-594"><a href="#cb70-594" aria-hidden="true" tabindex="-1"></a>    A --&gt; E[Points beyond whiskers: Outliers]</span>
<span id="cb70-595"><a href="#cb70-595" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-596"><a href="#cb70-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-597"><a href="#cb70-597" aria-hidden="true" tabindex="-1"></a><span class="fu">### Basic Box Plot</span></span>
<span id="cb70-598"><a href="#cb70-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-601"><a href="#cb70-601" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-602"><a href="#cb70-602" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-603"><a href="#cb70-603" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-604"><a href="#cb70-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-605"><a href="#cb70-605" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for different treatment groups</span></span>
<span id="cb70-606"><a href="#cb70-606" aria-hidden="true" tabindex="-1"></a>treatments <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb70-607"><a href="#cb70-607" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Drug A"</span>, <span class="st">"Drug B"</span>, <span class="st">"Drug C"</span>), <span class="at">each =</span> <span class="dv">25</span>),</span>
<span id="cb70-608"><a href="#cb70-608" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight_gain_kg =</span> <span class="fu">c</span>(</span>
<span id="cb70-609"><a href="#cb70-609" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">8</span>),   <span class="co"># Control</span></span>
<span id="cb70-610"><a href="#cb70-610" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="dv">58</span>, <span class="at">sd =</span> <span class="dv">7</span>),   <span class="co"># Drug A</span></span>
<span id="cb70-611"><a href="#cb70-611" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="dv">62</span>, <span class="at">sd =</span> <span class="dv">9</span>),   <span class="co"># Drug B</span></span>
<span id="cb70-612"><a href="#cb70-612" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="dv">55</span>, <span class="at">sd =</span> <span class="dv">6</span>)    <span class="co"># Drug C</span></span>
<span id="cb70-613"><a href="#cb70-613" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-614"><a href="#cb70-614" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-615"><a href="#cb70-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-616"><a href="#cb70-616" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot</span></span>
<span id="cb70-617"><a href="#cb70-617" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(treatments, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> weight_gain_kg)) <span class="sc">+</span></span>
<span id="cb70-618"><a href="#cb70-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb70-619"><a href="#cb70-619" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-620"><a href="#cb70-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-621"><a href="#cb70-621" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adding Color</span></span>
<span id="cb70-622"><a href="#cb70-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-625"><a href="#cb70-625" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-626"><a href="#cb70-626" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-627"><a href="#cb70-627" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-628"><a href="#cb70-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-629"><a href="#cb70-629" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(treatments, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> weight_gain_kg, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb70-630"><a href="#cb70-630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb70-631"><a href="#cb70-631" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-632"><a href="#cb70-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-633"><a href="#cb70-633" aria-hidden="true" tabindex="-1"></a><span class="fu">### Combining Box Plots with Individual Points</span></span>
<span id="cb70-634"><a href="#cb70-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-635"><a href="#cb70-635" aria-hidden="true" tabindex="-1"></a>It's often useful to show the underlying data along with the box plot:</span>
<span id="cb70-636"><a href="#cb70-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-639"><a href="#cb70-639" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-640"><a href="#cb70-640" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-641"><a href="#cb70-641" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-642"><a href="#cb70-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-643"><a href="#cb70-643" aria-hidden="true" tabindex="-1"></a><span class="co"># Add jittered points</span></span>
<span id="cb70-644"><a href="#cb70-644" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(treatments, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> weight_gain_kg, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb70-645"><a href="#cb70-645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb70-646"><a href="#cb70-646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb70-647"><a href="#cb70-647" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-648"><a href="#cb70-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-649"><a href="#cb70-649" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb70-650"><a href="#cb70-650" aria-hidden="true" tabindex="-1"></a><span class="fu">## `geom_jitter()` Reduces Overplotting</span></span>
<span id="cb70-651"><a href="#cb70-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-652"><a href="#cb70-652" aria-hidden="true" tabindex="-1"></a>When points overlap, <span class="in">`geom_jitter()`</span> adds small random horizontal noise to make them visible:</span>
<span id="cb70-653"><a href="#cb70-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-654"><a href="#cb70-654" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb70-655"><a href="#cb70-655" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>)  <span class="co"># Jitter horizontally (adjust width as needed)</span></span>
<span id="cb70-656"><a href="#cb70-656" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-657"><a href="#cb70-657" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-658"><a href="#cb70-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-659"><a href="#cb70-659" aria-hidden="true" tabindex="-1"></a><span class="fu">### When to Use Box Plots</span></span>
<span id="cb70-660"><a href="#cb70-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-661"><a href="#cb70-661" aria-hidden="true" tabindex="-1"></a>✅ **Use box plots when:**</span>
<span id="cb70-662"><a href="#cb70-662" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Comparing distributions across groups</span>
<span id="cb70-663"><a href="#cb70-663" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You want to show median, quartiles, and outliers</span>
<span id="cb70-664"><a href="#cb70-664" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You have multiple groups to compare</span>
<span id="cb70-665"><a href="#cb70-665" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You want a compact summary of distributions</span>
<span id="cb70-666"><a href="#cb70-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-667"><a href="#cb70-667" aria-hidden="true" tabindex="-1"></a>❌ **Don't use box plots when:**</span>
<span id="cb70-668"><a href="#cb70-668" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Your data has multiple modes (bimodal, multimodal) — box plots hide this</span>
<span id="cb70-669"><a href="#cb70-669" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You have very few data points (&lt; ~10 per group)</span>
<span id="cb70-670"><a href="#cb70-670" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You want to show exact distributions (use violin plots or histograms)</span>
<span id="cb70-671"><a href="#cb70-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-672"><a href="#cb70-672" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb70-673"><a href="#cb70-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-674"><a href="#cb70-674" aria-hidden="true" tabindex="-1"></a><span class="fu">## Violin Plots with `geom_violin()`</span></span>
<span id="cb70-675"><a href="#cb70-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-676"><a href="#cb70-676" aria-hidden="true" tabindex="-1"></a>Violin plots show the full distribution of data (like a density plot) rotated and mirrored. They're useful for showing distributions that box plots might hide.</span>
<span id="cb70-677"><a href="#cb70-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-678"><a href="#cb70-678" aria-hidden="true" tabindex="-1"></a><span class="fu">### Basic Violin Plot</span></span>
<span id="cb70-679"><a href="#cb70-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-682"><a href="#cb70-682" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-683"><a href="#cb70-683" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-684"><a href="#cb70-684" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-685"><a href="#cb70-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-686"><a href="#cb70-686" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(treatments, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> weight_gain_kg, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb70-687"><a href="#cb70-687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()</span>
<span id="cb70-688"><a href="#cb70-688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-689"><a href="#cb70-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-690"><a href="#cb70-690" aria-hidden="true" tabindex="-1"></a><span class="fu">### Combining Violin Plots with Box Plots</span></span>
<span id="cb70-691"><a href="#cb70-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-692"><a href="#cb70-692" aria-hidden="true" tabindex="-1"></a>A powerful combination: violin plot shows distribution, box plot shows summary statistics:</span>
<span id="cb70-693"><a href="#cb70-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-696"><a href="#cb70-696" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-697"><a href="#cb70-697" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-698"><a href="#cb70-698" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-699"><a href="#cb70-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-700"><a href="#cb70-700" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(treatments, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> weight_gain_kg, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb70-701"><a href="#cb70-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb70-702"><a href="#cb70-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"white"</span>)</span>
<span id="cb70-703"><a href="#cb70-703" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-704"><a href="#cb70-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-705"><a href="#cb70-705" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adding Points</span></span>
<span id="cb70-706"><a href="#cb70-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-709"><a href="#cb70-709" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-710"><a href="#cb70-710" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-711"><a href="#cb70-711" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-712"><a href="#cb70-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-713"><a href="#cb70-713" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(treatments, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> weight_gain_kg, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb70-714"><a href="#cb70-714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb70-715"><a href="#cb70-715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb70-716"><a href="#cb70-716" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-717"><a href="#cb70-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-718"><a href="#cb70-718" aria-hidden="true" tabindex="-1"></a><span class="fu">### When to Use Violin Plots</span></span>
<span id="cb70-719"><a href="#cb70-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-720"><a href="#cb70-720" aria-hidden="true" tabindex="-1"></a>✅ **Use violin plots when:**</span>
<span id="cb70-721"><a href="#cb70-721" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You want to show full distribution shape</span>
<span id="cb70-722"><a href="#cb70-722" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Your data might be bimodal or have multiple peaks</span>
<span id="cb70-723"><a href="#cb70-723" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Comparing distributions across groups</span>
<span id="cb70-724"><a href="#cb70-724" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You have enough data points (&gt; ~20 per group)</span>
<span id="cb70-725"><a href="#cb70-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-726"><a href="#cb70-726" aria-hidden="true" tabindex="-1"></a>❌ **Don't use violin plots when:**</span>
<span id="cb70-727"><a href="#cb70-727" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You have very few data points (distributions won't be smooth)</span>
<span id="cb70-728"><a href="#cb70-728" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Readers aren't familiar with violin plots (less intuitive than box plots)</span>
<span id="cb70-729"><a href="#cb70-729" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You only need summary statistics (use box plots)</span>
<span id="cb70-730"><a href="#cb70-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-731"><a href="#cb70-731" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb70-732"><a href="#cb70-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-733"><a href="#cb70-733" aria-hidden="true" tabindex="-1"></a><span class="fu">## Aesthetic Mappings: A Deeper Dive</span></span>
<span id="cb70-734"><a href="#cb70-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-735"><a href="#cb70-735" aria-hidden="true" tabindex="-1"></a>We've seen several aesthetics already. Let's consolidate what we know:</span>
<span id="cb70-736"><a href="#cb70-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-737"><a href="#cb70-737" aria-hidden="true" tabindex="-1"></a><span class="fu">### Common Aesthetics</span></span>
<span id="cb70-738"><a href="#cb70-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-739"><a href="#cb70-739" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Aesthetic <span class="pp">|</span> Type <span class="pp">|</span> Example <span class="pp">|</span> Best used with <span class="pp">|</span></span>
<span id="cb70-740"><a href="#cb70-740" aria-hidden="true" tabindex="-1"></a><span class="pp">|-----------|------|---------|----------------|</span></span>
<span id="cb70-741"><a href="#cb70-741" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`x`</span> <span class="pp">|</span> Position <span class="pp">|</span> <span class="in">`aes(x = treatment)`</span> <span class="pp">|</span> All geoms <span class="pp">|</span></span>
<span id="cb70-742"><a href="#cb70-742" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`y`</span> <span class="pp">|</span> Position <span class="pp">|</span> <span class="in">`aes(y = weight)`</span> <span class="pp">|</span> All geoms <span class="pp">|</span></span>
<span id="cb70-743"><a href="#cb70-743" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`color`</span> <span class="pp">|</span> Color <span class="pp">|</span> <span class="in">`aes(color = breed)`</span> <span class="pp">|</span> Points, lines, text <span class="pp">|</span></span>
<span id="cb70-744"><a href="#cb70-744" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`fill`</span> <span class="pp">|</span> Fill <span class="pp">|</span> <span class="in">`aes(fill = breed)`</span> <span class="pp">|</span> Bars, boxes, violins <span class="pp">|</span></span>
<span id="cb70-745"><a href="#cb70-745" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`size`</span> <span class="pp">|</span> Size <span class="pp">|</span> <span class="in">`aes(size = age)`</span> <span class="pp">|</span> Points, text <span class="pp">|</span></span>
<span id="cb70-746"><a href="#cb70-746" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`shape`</span> <span class="pp">|</span> Shape <span class="pp">|</span> <span class="in">`aes(shape = sex)`</span> <span class="pp">|</span> Points <span class="pp">|</span></span>
<span id="cb70-747"><a href="#cb70-747" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`alpha`</span> <span class="pp">|</span> Transparency <span class="pp">|</span> <span class="in">`aes(alpha = density)`</span> <span class="pp">|</span> All geoms <span class="pp">|</span></span>
<span id="cb70-748"><a href="#cb70-748" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`linetype`</span> <span class="pp">|</span> Line type <span class="pp">|</span> <span class="in">`aes(linetype = group)`</span> <span class="pp">|</span> Lines <span class="pp">|</span></span>
<span id="cb70-749"><a href="#cb70-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-750"><a href="#cb70-750" aria-hidden="true" tabindex="-1"></a><span class="fu">### Continuous vs Discrete Variables</span></span>
<span id="cb70-751"><a href="#cb70-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-752"><a href="#cb70-752" aria-hidden="true" tabindex="-1"></a>ggplot2 handles continuous and discrete variables differently:</span>
<span id="cb70-753"><a href="#cb70-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-756"><a href="#cb70-756" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-757"><a href="#cb70-757" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-758"><a href="#cb70-758" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-759"><a href="#cb70-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-760"><a href="#cb70-760" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data with both variable types</span></span>
<span id="cb70-761"><a href="#cb70-761" aria-hidden="true" tabindex="-1"></a>mixed_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb70-762"><a href="#cb70-762" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">each =</span> <span class="dv">20</span>),  <span class="co"># Discrete</span></span>
<span id="cb70-763"><a href="#cb70-763" aria-hidden="true" tabindex="-1"></a>  <span class="at">score =</span> <span class="fu">rnorm</span>(<span class="dv">60</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>),    <span class="co"># Continuous</span></span>
<span id="cb70-764"><a href="#cb70-764" aria-hidden="true" tabindex="-1"></a>  <span class="at">intensity =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">times =</span> <span class="dv">3</span>)           <span class="co"># Continuous</span></span>
<span id="cb70-765"><a href="#cb70-765" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-766"><a href="#cb70-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-767"><a href="#cb70-767" aria-hidden="true" tabindex="-1"></a><span class="co"># Color by discrete variable (gets distinct colors)</span></span>
<span id="cb70-768"><a href="#cb70-768" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mixed_data, <span class="fu">aes</span>(<span class="at">x =</span> intensity, <span class="at">y =</span> score, <span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb70-769"><a href="#cb70-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb70-770"><a href="#cb70-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-771"><a href="#cb70-771" aria-hidden="true" tabindex="-1"></a><span class="co"># Color by continuous variable (gets gradient)</span></span>
<span id="cb70-772"><a href="#cb70-772" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mixed_data, <span class="fu">aes</span>(<span class="at">x =</span> intensity, <span class="at">y =</span> score, <span class="at">color =</span> intensity)) <span class="sc">+</span></span>
<span id="cb70-773"><a href="#cb70-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb70-774"><a href="#cb70-774" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-775"><a href="#cb70-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-776"><a href="#cb70-776" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb70-777"><a href="#cb70-777" aria-hidden="true" tabindex="-1"></a><span class="fu">## Choosing the Right Aesthetic</span></span>
<span id="cb70-778"><a href="#cb70-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-779"><a href="#cb70-779" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Categorical data**: Use <span class="in">`color`</span>, <span class="in">`fill`</span>, <span class="in">`shape`</span>, <span class="in">`linetype`</span></span>
<span id="cb70-780"><a href="#cb70-780" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Continuous data**: Use <span class="in">`x`</span>, <span class="in">`y`</span>, <span class="in">`size`</span>, <span class="in">`alpha`</span>, <span class="in">`color`</span> (gradient)</span>
<span id="cb70-781"><a href="#cb70-781" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Too many categories?** (&gt; ~7): Don't use <span class="in">`shape`</span> (hard to distinguish); consider faceting instead</span>
<span id="cb70-782"><a href="#cb70-782" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-783"><a href="#cb70-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-784"><a href="#cb70-784" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb70-785"><a href="#cb70-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-786"><a href="#cb70-786" aria-hidden="true" tabindex="-1"></a><span class="fu">## Working with Scales</span></span>
<span id="cb70-787"><a href="#cb70-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-788"><a href="#cb70-788" aria-hidden="true" tabindex="-1"></a>Scales control how data values map to visual properties. Every aesthetic has a scale.</span>
<span id="cb70-789"><a href="#cb70-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-790"><a href="#cb70-790" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scale Functions</span></span>
<span id="cb70-791"><a href="#cb70-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-792"><a href="#cb70-792" aria-hidden="true" tabindex="-1"></a>Scale functions follow the pattern: <span class="in">`scale_&lt;aesthetic&gt;_&lt;type&gt;()`</span></span>
<span id="cb70-793"><a href="#cb70-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-794"><a href="#cb70-794" aria-hidden="true" tabindex="-1"></a>Examples:</span>
<span id="cb70-795"><a href="#cb70-795" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`scale_x_continuous()`</span> — Continuous x-axis</span>
<span id="cb70-796"><a href="#cb70-796" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`scale_y_log10()`</span> — Log10 transform y-axis</span>
<span id="cb70-797"><a href="#cb70-797" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`scale_color_manual()`</span> — Manually specify colors</span>
<span id="cb70-798"><a href="#cb70-798" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`scale_fill_brewer()`</span> — Use ColorBrewer palettes</span>
<span id="cb70-799"><a href="#cb70-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-800"><a href="#cb70-800" aria-hidden="true" tabindex="-1"></a><span class="fu">### Modifying Continuous Scales</span></span>
<span id="cb70-801"><a href="#cb70-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-804"><a href="#cb70-804" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-805"><a href="#cb70-805" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-806"><a href="#cb70-806" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-807"><a href="#cb70-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-808"><a href="#cb70-808" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb70-809"><a href="#cb70-809" aria-hidden="true" tabindex="-1"></a>growth_rate <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb70-810"><a href="#cb70-810" aria-hidden="true" tabindex="-1"></a>  <span class="at">animal_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>,</span>
<span id="cb70-811"><a href="#cb70-811" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight_kg =</span> <span class="fu">runif</span>(<span class="dv">30</span>, <span class="at">min =</span> <span class="dv">400</span>, <span class="at">max =</span> <span class="dv">700</span>),</span>
<span id="cb70-812"><a href="#cb70-812" aria-hidden="true" tabindex="-1"></a>  <span class="at">gain_per_day_kg =</span> <span class="fu">runif</span>(<span class="dv">30</span>, <span class="at">min =</span> <span class="fl">0.8</span>, <span class="at">max =</span> <span class="fl">1.5</span>)</span>
<span id="cb70-813"><a href="#cb70-813" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-814"><a href="#cb70-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-815"><a href="#cb70-815" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify axis limits and breaks</span></span>
<span id="cb70-816"><a href="#cb70-816" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(growth_rate, <span class="fu">aes</span>(<span class="at">x =</span> weight_kg, <span class="at">y =</span> gain_per_day_kg)) <span class="sc">+</span></span>
<span id="cb70-817"><a href="#cb70-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb70-818"><a href="#cb70-818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">350</span>, <span class="dv">750</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">350</span>, <span class="dv">750</span>, <span class="at">by =</span> <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb70-819"><a href="#cb70-819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.5</span>))</span>
<span id="cb70-820"><a href="#cb70-820" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-821"><a href="#cb70-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-822"><a href="#cb70-822" aria-hidden="true" tabindex="-1"></a><span class="fu">### Log Transformations</span></span>
<span id="cb70-823"><a href="#cb70-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-826"><a href="#cb70-826" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-827"><a href="#cb70-827" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-828"><a href="#cb70-828" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-829"><a href="#cb70-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-830"><a href="#cb70-830" aria-hidden="true" tabindex="-1"></a><span class="co"># Data with exponential relationship</span></span>
<span id="cb70-831"><a href="#cb70-831" aria-hidden="true" tabindex="-1"></a>bacteria <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb70-832"><a href="#cb70-832" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_hours =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">24</span>,</span>
<span id="cb70-833"><a href="#cb70-833" aria-hidden="true" tabindex="-1"></a>  <span class="at">count =</span> <span class="dv">100</span> <span class="sc">*</span> <span class="dv">2</span><span class="sc">^</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">24</span> <span class="sc">/</span> <span class="dv">4</span>)  <span class="co"># Exponential growth</span></span>
<span id="cb70-834"><a href="#cb70-834" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-835"><a href="#cb70-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-836"><a href="#cb70-836" aria-hidden="true" tabindex="-1"></a><span class="co"># Regular scale (hard to see early values)</span></span>
<span id="cb70-837"><a href="#cb70-837" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bacteria, <span class="fu">aes</span>(<span class="at">x =</span> time_hours, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb70-838"><a href="#cb70-838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb70-839"><a href="#cb70-839" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb70-840"><a href="#cb70-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-841"><a href="#cb70-841" aria-hidden="true" tabindex="-1"></a><span class="co"># Log scale (easier to see pattern)</span></span>
<span id="cb70-842"><a href="#cb70-842" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bacteria, <span class="fu">aes</span>(<span class="at">x =</span> time_hours, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb70-843"><a href="#cb70-843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb70-844"><a href="#cb70-844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb70-845"><a href="#cb70-845" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span>
<span id="cb70-846"><a href="#cb70-846" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-847"><a href="#cb70-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-848"><a href="#cb70-848" aria-hidden="true" tabindex="-1"></a><span class="fu">### Discrete Scales: Manual Colors</span></span>
<span id="cb70-849"><a href="#cb70-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-852"><a href="#cb70-852" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-853"><a href="#cb70-853" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-854"><a href="#cb70-854" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-855"><a href="#cb70-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-856"><a href="#cb70-856" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify custom colors</span></span>
<span id="cb70-857"><a href="#cb70-857" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg, <span class="at">color =</span> breed)) <span class="sc">+</span></span>
<span id="cb70-858"><a href="#cb70-858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb70-859"><a href="#cb70-859" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Holstein"</span> <span class="ot">=</span> <span class="st">"blue"</span>,</span>
<span id="cb70-860"><a href="#cb70-860" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Jersey"</span> <span class="ot">=</span> <span class="st">"orange"</span>,</span>
<span id="cb70-861"><a href="#cb70-861" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Angus"</span> <span class="ot">=</span> <span class="st">"darkred"</span>))</span>
<span id="cb70-862"><a href="#cb70-862" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-863"><a href="#cb70-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-864"><a href="#cb70-864" aria-hidden="true" tabindex="-1"></a><span class="fu">### Using ColorBrewer Palettes</span></span>
<span id="cb70-865"><a href="#cb70-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-868"><a href="#cb70-868" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-869"><a href="#cb70-869" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-870"><a href="#cb70-870" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-871"><a href="#cb70-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-872"><a href="#cb70-872" aria-hidden="true" tabindex="-1"></a><span class="co"># Use ColorBrewer palette (colorblind-friendly)</span></span>
<span id="cb70-873"><a href="#cb70-873" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg, <span class="at">color =</span> breed)) <span class="sc">+</span></span>
<span id="cb70-874"><a href="#cb70-874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb70-875"><a href="#cb70-875" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)</span>
<span id="cb70-876"><a href="#cb70-876" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-877"><a href="#cb70-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-878"><a href="#cb70-878" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb70-879"><a href="#cb70-879" aria-hidden="true" tabindex="-1"></a><span class="fu">## Colorblind-Friendly Palettes</span></span>
<span id="cb70-880"><a href="#cb70-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-881"><a href="#cb70-881" aria-hidden="true" tabindex="-1"></a>Use <span class="in">`scale_color_viridis_d()`</span> (discrete) or <span class="in">`scale_color_viridis_c()`</span> (continuous) for accessible colors:</span>
<span id="cb70-882"><a href="#cb70-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-883"><a href="#cb70-883" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb70-884"><a href="#cb70-884" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_color_viridis_d</span>()  <span class="co"># Discrete variable</span></span>
<span id="cb70-885"><a href="#cb70-885" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_color_viridis_c</span>()  <span class="co"># Continuous variable</span></span>
<span id="cb70-886"><a href="#cb70-886" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-887"><a href="#cb70-887" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-888"><a href="#cb70-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-889"><a href="#cb70-889" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb70-890"><a href="#cb70-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-891"><a href="#cb70-891" aria-hidden="true" tabindex="-1"></a><span class="fu">## Labels and Titles with `labs()`</span></span>
<span id="cb70-892"><a href="#cb70-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-893"><a href="#cb70-893" aria-hidden="true" tabindex="-1"></a>Use <span class="in">`labs()`</span> to add or modify plot labels:</span>
<span id="cb70-894"><a href="#cb70-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-897"><a href="#cb70-897" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-898"><a href="#cb70-898" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-899"><a href="#cb70-899" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-900"><a href="#cb70-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-901"><a href="#cb70-901" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg, <span class="at">color =</span> breed)) <span class="sc">+</span></span>
<span id="cb70-902"><a href="#cb70-902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb70-903"><a href="#cb70-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb70-904"><a href="#cb70-904" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship Between Feed Intake and Weight Gain"</span>,</span>
<span id="cb70-905"><a href="#cb70-905" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Data from 30 cattle across three breeds"</span>,</span>
<span id="cb70-906"><a href="#cb70-906" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Daily Feed Intake (kg)"</span>,</span>
<span id="cb70-907"><a href="#cb70-907" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Daily Weight Gain (kg)"</span>,</span>
<span id="cb70-908"><a href="#cb70-908" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Breed"</span>,</span>
<span id="cb70-909"><a href="#cb70-909" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Source: Fictional farm data (2024)"</span></span>
<span id="cb70-910"><a href="#cb70-910" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-911"><a href="#cb70-911" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-912"><a href="#cb70-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-913"><a href="#cb70-913" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb70-914"><a href="#cb70-914" aria-hidden="true" tabindex="-1"></a><span class="fu">## Label Arguments in `labs()`</span></span>
<span id="cb70-915"><a href="#cb70-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-916"><a href="#cb70-916" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`title`</span> — Main plot title</span>
<span id="cb70-917"><a href="#cb70-917" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`subtitle`</span> — Secondary title (smaller font)</span>
<span id="cb70-918"><a href="#cb70-918" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`x`</span>, <span class="in">`y`</span> — Axis labels</span>
<span id="cb70-919"><a href="#cb70-919" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`color`</span>, <span class="in">`fill`</span>, <span class="in">`shape`</span>, <span class="in">`size`</span> — Legend titles (match the aesthetic name)</span>
<span id="cb70-920"><a href="#cb70-920" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`caption`</span> — Small text at bottom (often for data source or notes)</span>
<span id="cb70-921"><a href="#cb70-921" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-922"><a href="#cb70-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-923"><a href="#cb70-923" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb70-924"><a href="#cb70-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-925"><a href="#cb70-925" aria-hidden="true" tabindex="-1"></a><span class="fu">## Themes: Customizing Plot Appearance</span></span>
<span id="cb70-926"><a href="#cb70-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-927"><a href="#cb70-927" aria-hidden="true" tabindex="-1"></a>Themes control the non-data elements of your plot (background, grid lines, fonts, etc.).</span>
<span id="cb70-928"><a href="#cb70-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-929"><a href="#cb70-929" aria-hidden="true" tabindex="-1"></a><span class="fu">### Built-in Themes</span></span>
<span id="cb70-930"><a href="#cb70-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-931"><a href="#cb70-931" aria-hidden="true" tabindex="-1"></a>ggplot2 includes several complete themes:</span>
<span id="cb70-932"><a href="#cb70-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-935"><a href="#cb70-935" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-936"><a href="#cb70-936" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-937"><a href="#cb70-937" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-938"><a href="#cb70-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-939"><a href="#cb70-939" aria-hidden="true" tabindex="-1"></a><span class="co"># Create base plot</span></span>
<span id="cb70-940"><a href="#cb70-940" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg, <span class="at">color =</span> breed)) <span class="sc">+</span></span>
<span id="cb70-941"><a href="#cb70-941" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb70-942"><a href="#cb70-942" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Feed Intake vs Weight Gain"</span>)</span>
<span id="cb70-943"><a href="#cb70-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-944"><a href="#cb70-944" aria-hidden="true" tabindex="-1"></a><span class="co"># Default theme (theme_gray)</span></span>
<span id="cb70-945"><a href="#cb70-945" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb70-946"><a href="#cb70-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-947"><a href="#cb70-947" aria-hidden="true" tabindex="-1"></a><span class="co"># theme_minimal() - Clean and modern</span></span>
<span id="cb70-948"><a href="#cb70-948" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb70-949"><a href="#cb70-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-950"><a href="#cb70-950" aria-hidden="true" tabindex="-1"></a><span class="co"># theme_classic() - No grid lines</span></span>
<span id="cb70-951"><a href="#cb70-951" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb70-952"><a href="#cb70-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-953"><a href="#cb70-953" aria-hidden="true" tabindex="-1"></a><span class="co"># theme_bw() - Black and white</span></span>
<span id="cb70-954"><a href="#cb70-954" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb70-955"><a href="#cb70-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-956"><a href="#cb70-956" aria-hidden="true" tabindex="-1"></a><span class="co"># theme_light() - Light gray grid</span></span>
<span id="cb70-957"><a href="#cb70-957" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_light</span>()</span>
<span id="cb70-958"><a href="#cb70-958" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-959"><a href="#cb70-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-960"><a href="#cb70-960" aria-hidden="true" tabindex="-1"></a><span class="fu">### Setting a Default Theme</span></span>
<span id="cb70-961"><a href="#cb70-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-962"><a href="#cb70-962" aria-hidden="true" tabindex="-1"></a>You can set a theme for all plots in your session:</span>
<span id="cb70-963"><a href="#cb70-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-966"><a href="#cb70-966" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-967"><a href="#cb70-967" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb70-968"><a href="#cb70-968" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-969"><a href="#cb70-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-970"><a href="#cb70-970" aria-hidden="true" tabindex="-1"></a><span class="co"># Set default theme for all subsequent plots</span></span>
<span id="cb70-971"><a href="#cb70-971" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span>
<span id="cb70-972"><a href="#cb70-972" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-973"><a href="#cb70-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-974"><a href="#cb70-974" aria-hidden="true" tabindex="-1"></a><span class="fu">### Customizing Themes</span></span>
<span id="cb70-975"><a href="#cb70-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-976"><a href="#cb70-976" aria-hidden="true" tabindex="-1"></a>Use <span class="in">`theme()`</span> to modify specific elements:</span>
<span id="cb70-977"><a href="#cb70-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-980"><a href="#cb70-980" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-981"><a href="#cb70-981" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-982"><a href="#cb70-982" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-983"><a href="#cb70-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-984"><a href="#cb70-984" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg, <span class="at">color =</span> breed)) <span class="sc">+</span></span>
<span id="cb70-985"><a href="#cb70-985" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb70-986"><a href="#cb70-986" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Feed Intake vs Weight Gain"</span>) <span class="sc">+</span></span>
<span id="cb70-987"><a href="#cb70-987" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb70-988"><a href="#cb70-988" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb70-989"><a href="#cb70-989" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb70-990"><a href="#cb70-990" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb70-991"><a href="#cb70-991" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb70-992"><a href="#cb70-992" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-993"><a href="#cb70-993" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-994"><a href="#cb70-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-995"><a href="#cb70-995" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb70-996"><a href="#cb70-996" aria-hidden="true" tabindex="-1"></a><span class="fu">## Common Theme Customizations</span></span>
<span id="cb70-997"><a href="#cb70-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-998"><a href="#cb70-998" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb70-999"><a href="#cb70-999" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(</span>
<span id="cb70-1000"><a href="#cb70-1000" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb70-1001"><a href="#cb70-1001" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb70-1002"><a href="#cb70-1002" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.position =</span> <span class="st">"bottom"</span>,  <span class="co"># or "top", "left", "right", "none"</span></span>
<span id="cb70-1003"><a href="#cb70-1003" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"gray90"</span>),</span>
<span id="cb70-1004"><a href="#cb70-1004" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb70-1005"><a href="#cb70-1005" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-1006"><a href="#cb70-1006" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1007"><a href="#cb70-1007" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-1008"><a href="#cb70-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1009"><a href="#cb70-1009" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb70-1010"><a href="#cb70-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1011"><a href="#cb70-1011" aria-hidden="true" tabindex="-1"></a><span class="fu">## Coordinate Systems</span></span>
<span id="cb70-1012"><a href="#cb70-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1013"><a href="#cb70-1013" aria-hidden="true" tabindex="-1"></a>Coordinate systems control how the x and y axes are rendered.</span>
<span id="cb70-1014"><a href="#cb70-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1015"><a href="#cb70-1015" aria-hidden="true" tabindex="-1"></a><span class="fu">### `coord_cartesian()`: Zooming</span></span>
<span id="cb70-1016"><a href="#cb70-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1017"><a href="#cb70-1017" aria-hidden="true" tabindex="-1"></a><span class="in">`coord_cartesian()`</span> is useful for zooming without removing data:</span>
<span id="cb70-1018"><a href="#cb70-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1021"><a href="#cb70-1021" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1022"><a href="#cb70-1022" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-1023"><a href="#cb70-1023" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-1024"><a href="#cb70-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1025"><a href="#cb70-1025" aria-hidden="true" tabindex="-1"></a><span class="co"># Zoom in on a specific region</span></span>
<span id="cb70-1026"><a href="#cb70-1026" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg, <span class="at">color =</span> breed)) <span class="sc">+</span></span>
<span id="cb70-1027"><a href="#cb70-1027" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb70-1028"><a href="#cb70-1028" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">26</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">1.2</span>))</span>
<span id="cb70-1029"><a href="#cb70-1029" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1030"><a href="#cb70-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1031"><a href="#cb70-1031" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb70-1032"><a href="#cb70-1032" aria-hidden="true" tabindex="-1"></a><span class="fu">## `coord_cartesian()` vs `scale_*_continuous(limits = ...)`</span></span>
<span id="cb70-1033"><a href="#cb70-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1034"><a href="#cb70-1034" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`coord_cartesian(xlim = c(a, b))`</span> — **Zooms** without removing data (stat calculations use all data)</span>
<span id="cb70-1035"><a href="#cb70-1035" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`scale_x_continuous(limits = c(a, b))`</span> — **Removes** data outside limits before plotting</span>
<span id="cb70-1036"><a href="#cb70-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1037"><a href="#cb70-1037" aria-hidden="true" tabindex="-1"></a>Usually, you want <span class="in">`coord_cartesian()`</span> for zooming.</span>
<span id="cb70-1038"><a href="#cb70-1038" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-1039"><a href="#cb70-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1040"><a href="#cb70-1040" aria-hidden="true" tabindex="-1"></a><span class="fu">### `coord_flip()`: Horizontal Plots</span></span>
<span id="cb70-1041"><a href="#cb70-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1042"><a href="#cb70-1042" aria-hidden="true" tabindex="-1"></a>We saw this earlier with bar charts. It swaps x and y:</span>
<span id="cb70-1043"><a href="#cb70-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1046"><a href="#cb70-1046" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1047"><a href="#cb70-1047" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-1048"><a href="#cb70-1048" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-1049"><a href="#cb70-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1050"><a href="#cb70-1050" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(milk_production, <span class="fu">aes</span>(<span class="at">x =</span> breed, <span class="at">y =</span> avg_liters_per_day)) <span class="sc">+</span></span>
<span id="cb70-1051"><a href="#cb70-1051" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb70-1052"><a href="#cb70-1052" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb70-1053"><a href="#cb70-1053" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1054"><a href="#cb70-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1055"><a href="#cb70-1055" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fixed Aspect Ratio</span></span>
<span id="cb70-1056"><a href="#cb70-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1057"><a href="#cb70-1057" aria-hidden="true" tabindex="-1"></a><span class="in">`coord_fixed()`</span> ensures equal scales on both axes (1 unit on x = 1 unit on y visually):</span>
<span id="cb70-1058"><a href="#cb70-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1061"><a href="#cb70-1061" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1062"><a href="#cb70-1062" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb70-1063"><a href="#cb70-1063" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-1064"><a href="#cb70-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1065"><a href="#cb70-1065" aria-hidden="true" tabindex="-1"></a><span class="co"># Without fixed aspect ratio</span></span>
<span id="cb70-1066"><a href="#cb70-1066" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg)) <span class="sc">+</span></span>
<span id="cb70-1067"><a href="#cb70-1067" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb70-1068"><a href="#cb70-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1069"><a href="#cb70-1069" aria-hidden="true" tabindex="-1"></a><span class="co"># With fixed aspect ratio</span></span>
<span id="cb70-1070"><a href="#cb70-1070" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg)) <span class="sc">+</span></span>
<span id="cb70-1071"><a href="#cb70-1071" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb70-1072"><a href="#cb70-1072" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> <span class="dv">20</span>)  <span class="co"># 20 kg of feed = 1 kg weight gain visually</span></span>
<span id="cb70-1073"><a href="#cb70-1073" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1074"><a href="#cb70-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1075"><a href="#cb70-1075" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb70-1076"><a href="#cb70-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1077"><a href="#cb70-1077" aria-hidden="true" tabindex="-1"></a><span class="fu">## Saving Plots with `ggsave()`</span></span>
<span id="cb70-1078"><a href="#cb70-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1079"><a href="#cb70-1079" aria-hidden="true" tabindex="-1"></a>After creating a plot, save it with <span class="in">`ggsave()`</span>:</span>
<span id="cb70-1080"><a href="#cb70-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1083"><a href="#cb70-1083" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1084"><a href="#cb70-1084" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb70-1085"><a href="#cb70-1085" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-1086"><a href="#cb70-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1087"><a href="#cb70-1087" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb70-1088"><a href="#cb70-1088" aria-hidden="true" tabindex="-1"></a>my_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cattle, <span class="fu">aes</span>(<span class="at">x =</span> feed_intake_kg, <span class="at">y =</span> weight_gain_kg, <span class="at">color =</span> breed)) <span class="sc">+</span></span>
<span id="cb70-1089"><a href="#cb70-1089" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb70-1090"><a href="#cb70-1090" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Feed Intake vs Weight Gain"</span>) <span class="sc">+</span></span>
<span id="cb70-1091"><a href="#cb70-1091" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb70-1092"><a href="#cb70-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1093"><a href="#cb70-1093" aria-hidden="true" tabindex="-1"></a><span class="co"># Save to file</span></span>
<span id="cb70-1094"><a href="#cb70-1094" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"cattle_plot.png"</span>, <span class="at">plot =</span> my_plot, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb70-1095"><a href="#cb70-1095" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1096"><a href="#cb70-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1097"><a href="#cb70-1097" aria-hidden="true" tabindex="-1"></a><span class="fu">### Common Arguments</span></span>
<span id="cb70-1098"><a href="#cb70-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1099"><a href="#cb70-1099" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Argument <span class="pp">|</span> What it does <span class="pp">|</span> Example <span class="pp">|</span></span>
<span id="cb70-1100"><a href="#cb70-1100" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------|--------------|---------|</span></span>
<span id="cb70-1101"><a href="#cb70-1101" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`filename`</span> <span class="pp">|</span> File path and name <span class="pp">|</span> <span class="in">`"plots/figure1.png"`</span> <span class="pp">|</span></span>
<span id="cb70-1102"><a href="#cb70-1102" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`plot`</span> <span class="pp">|</span> ggplot object (defaults to last plot) <span class="pp">|</span> <span class="in">`my_plot`</span> <span class="pp">|</span></span>
<span id="cb70-1103"><a href="#cb70-1103" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`width`</span> <span class="pp">|</span> Width in inches (or cm, mm) <span class="pp">|</span> <span class="in">`8`</span> <span class="pp">|</span></span>
<span id="cb70-1104"><a href="#cb70-1104" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`height`</span> <span class="pp">|</span> Height in inches (or cm, mm) <span class="pp">|</span> <span class="in">`6`</span> <span class="pp">|</span></span>
<span id="cb70-1105"><a href="#cb70-1105" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`dpi`</span> <span class="pp">|</span> Resolution (dots per inch) <span class="pp">|</span> <span class="in">`300`</span> (publication quality) <span class="pp">|</span></span>
<span id="cb70-1106"><a href="#cb70-1106" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`units`</span> <span class="pp">|</span> Units for width/height <span class="pp">|</span> <span class="in">`"in"`</span>, <span class="in">`"cm"`</span>, <span class="in">`"mm"`</span> <span class="pp">|</span></span>
<span id="cb70-1107"><a href="#cb70-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1108"><a href="#cb70-1108" aria-hidden="true" tabindex="-1"></a><span class="fu">### File Formats</span></span>
<span id="cb70-1109"><a href="#cb70-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1110"><a href="#cb70-1110" aria-hidden="true" tabindex="-1"></a>ggplot2 supports many formats (determined by file extension):</span>
<span id="cb70-1111"><a href="#cb70-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1112"><a href="#cb70-1112" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**PNG** (<span class="in">`.png`</span>) — Good for presentations, web (raster)</span>
<span id="cb70-1113"><a href="#cb70-1113" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**PDF** (<span class="in">`.pdf`</span>) — Best for publications (vector, scalable)</span>
<span id="cb70-1114"><a href="#cb70-1114" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**JPEG** (<span class="in">`.jpg`</span>) — Compressed (raster, smaller files)</span>
<span id="cb70-1115"><a href="#cb70-1115" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**SVG** (<span class="in">`.svg`</span>) — Vector format for web</span>
<span id="cb70-1116"><a href="#cb70-1116" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**TIFF** (<span class="in">`.tiff`</span>) — High quality (raster, large files)</span>
<span id="cb70-1117"><a href="#cb70-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1120"><a href="#cb70-1120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1121"><a href="#cb70-1121" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb70-1122"><a href="#cb70-1122" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-1123"><a href="#cb70-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1124"><a href="#cb70-1124" aria-hidden="true" tabindex="-1"></a><span class="co"># Save as PDF (recommended for publications)</span></span>
<span id="cb70-1125"><a href="#cb70-1125" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"figure1.pdf"</span>, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb70-1126"><a href="#cb70-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1127"><a href="#cb70-1127" aria-hidden="true" tabindex="-1"></a><span class="co"># Save as high-resolution PNG</span></span>
<span id="cb70-1128"><a href="#cb70-1128" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"figure1.png"</span>, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb70-1129"><a href="#cb70-1129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1130"><a href="#cb70-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1131"><a href="#cb70-1131" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb70-1132"><a href="#cb70-1132" aria-hidden="true" tabindex="-1"></a><span class="fu">## Publication Guidelines</span></span>
<span id="cb70-1133"><a href="#cb70-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1134"><a href="#cb70-1134" aria-hidden="true" tabindex="-1"></a>Most journals require:</span>
<span id="cb70-1135"><a href="#cb70-1135" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**300 dpi** minimum resolution</span>
<span id="cb70-1136"><a href="#cb70-1136" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**PDF** or **TIFF** format for final submission</span>
<span id="cb70-1137"><a href="#cb70-1137" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Specific dimensions (check journal guidelines)</span>
<span id="cb70-1138"><a href="#cb70-1138" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Readable fonts (usually at least 8-10 pt in final figure)</span>
<span id="cb70-1139"><a href="#cb70-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1140"><a href="#cb70-1140" aria-hidden="true" tabindex="-1"></a>Start with:</span>
<span id="cb70-1141"><a href="#cb70-1141" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb70-1142"><a href="#cb70-1142" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"figure.pdf"</span>, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb70-1143"><a href="#cb70-1143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1144"><a href="#cb70-1144" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-1145"><a href="#cb70-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1146"><a href="#cb70-1146" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb70-1147"><a href="#cb70-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1148"><a href="#cb70-1148" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary: Choosing the Right Plot Type</span></span>
<span id="cb70-1149"><a href="#cb70-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1150"><a href="#cb70-1150" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Data Type <span class="pp">|</span> Goal <span class="pp">|</span> Recommended Plot <span class="pp">|</span></span>
<span id="cb70-1151"><a href="#cb70-1151" aria-hidden="true" tabindex="-1"></a><span class="pp">|-----------|------|------------------|</span></span>
<span id="cb70-1152"><a href="#cb70-1152" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 2 continuous variables <span class="pp">|</span> Show relationship <span class="pp">|</span> **Scatter plot** (<span class="in">`geom_point`</span>) <span class="pp">|</span></span>
<span id="cb70-1153"><a href="#cb70-1153" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Time series <span class="pp">|</span> Show change over time <span class="pp">|</span> **Line plot** (<span class="in">`geom_line`</span>) <span class="pp">|</span></span>
<span id="cb70-1154"><a href="#cb70-1154" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Categorical + continuous <span class="pp">|</span> Compare groups <span class="pp">|</span> **Bar chart** (`geom_col`), **Box plot** (<span class="in">`geom_boxplot`</span>) <span class="pp">|</span></span>
<span id="cb70-1155"><a href="#cb70-1155" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1 continuous variable <span class="pp">|</span> Show distribution <span class="pp">|</span> **Histogram** (`geom_histogram`), **Density plot** <span class="pp">|</span></span>
<span id="cb70-1156"><a href="#cb70-1156" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Multiple groups + continuous <span class="pp">|</span> Compare distributions <span class="pp">|</span> **Box plot** (`geom_boxplot`), **Violin plot** (<span class="in">`geom_violin`</span>) <span class="pp">|</span></span>
<span id="cb70-1157"><a href="#cb70-1157" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Counts of categories <span class="pp">|</span> Show frequencies <span class="pp">|</span> **Bar chart** (<span class="in">`geom_bar`</span>) <span class="pp">|</span></span>
<span id="cb70-1158"><a href="#cb70-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1159"><a href="#cb70-1159" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Concepts Review</span></span>
<span id="cb70-1160"><a href="#cb70-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1161"><a href="#cb70-1161" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Three essentials**: Data + <span class="in">`aes()`</span> + <span class="in">`geom_*()`</span></span>
<span id="cb70-1162"><a href="#cb70-1162" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Layers**: Build plots by adding layers with <span class="in">`+`</span></span>
<span id="cb70-1163"><a href="#cb70-1163" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Aesthetics**: Map variables to visual properties (<span class="in">`aes()`</span>)</span>
<span id="cb70-1164"><a href="#cb70-1164" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Geoms**: Choose the right plot type for your data</span>
<span id="cb70-1165"><a href="#cb70-1165" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Scales**: Control how data maps to visuals</span>
<span id="cb70-1166"><a href="#cb70-1166" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>**Labels**: Always label axes and legends clearly (<span class="in">`labs()`</span>)</span>
<span id="cb70-1167"><a href="#cb70-1167" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>**Themes**: Customize appearance for publication</span>
<span id="cb70-1168"><a href="#cb70-1168" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>**Save**: Use <span class="in">`ggsave()`</span> with appropriate format and resolution</span>
<span id="cb70-1169"><a href="#cb70-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1170"><a href="#cb70-1170" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb70-1171"><a href="#cb70-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1172"><a href="#cb70-1172" aria-hidden="true" tabindex="-1"></a><span class="fu">## Week 5 Homework: Creating Publication-Ready Plots</span></span>
<span id="cb70-1173"><a href="#cb70-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1174"><a href="#cb70-1174" aria-hidden="true" tabindex="-1"></a><span class="fu">### Assignment Overview</span></span>
<span id="cb70-1175"><a href="#cb70-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1176"><a href="#cb70-1176" aria-hidden="true" tabindex="-1"></a>You will create **5 different types of plots** from a provided dataset and present them in a professional Quarto report. Focus on choosing appropriate plot types, applying proper labels, and using themes effectively.</span>
<span id="cb70-1177"><a href="#cb70-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1178"><a href="#cb70-1178" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dataset</span></span>
<span id="cb70-1179"><a href="#cb70-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1180"><a href="#cb70-1180" aria-hidden="true" tabindex="-1"></a>You'll use simulated data from a sheep grazing study:</span>
<span id="cb70-1181"><a href="#cb70-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1184"><a href="#cb70-1184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1185"><a href="#cb70-1185" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb70-1186"><a href="#cb70-1186" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-1187"><a href="#cb70-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1188"><a href="#cb70-1188" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate dataset (include this in your homework)</span></span>
<span id="cb70-1189"><a href="#cb70-1189" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2024</span>)</span>
<span id="cb70-1190"><a href="#cb70-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1191"><a href="#cb70-1191" aria-hidden="true" tabindex="-1"></a>sheep_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb70-1192"><a href="#cb70-1192" aria-hidden="true" tabindex="-1"></a>  <span class="at">sheep_id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">60</span>, <span class="at">each =</span> <span class="dv">4</span>),</span>
<span id="cb70-1193"><a href="#cb70-1193" aria-hidden="true" tabindex="-1"></a>  <span class="at">breed =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Merino"</span>, <span class="st">"Suffolk"</span>, <span class="st">"Dorper"</span>), <span class="at">each =</span> <span class="dv">20</span>), <span class="at">each =</span> <span class="dv">4</span>),</span>
<span id="cb70-1194"><a href="#cb70-1194" aria-hidden="true" tabindex="-1"></a>  <span class="at">pasture_type =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Native"</span>, <span class="st">"Improved"</span>), <span class="at">each =</span> <span class="dv">30</span>), <span class="at">each =</span> <span class="dv">4</span>),</span>
<span id="cb70-1195"><a href="#cb70-1195" aria-hidden="true" tabindex="-1"></a>  <span class="at">week =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">12</span>), <span class="at">times =</span> <span class="dv">60</span>),</span>
<span id="cb70-1196"><a href="#cb70-1196" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight_kg =</span> <span class="fu">rep</span>(<span class="fu">rnorm</span>(<span class="dv">60</span>, <span class="at">mean =</span> <span class="dv">45</span>, <span class="at">sd =</span> <span class="dv">5</span>), <span class="at">each =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb70-1197"><a href="#cb70-1197" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">12</span>), <span class="at">times =</span> <span class="dv">60</span>) <span class="sc">+</span></span>
<span id="cb70-1198"><a href="#cb70-1198" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">240</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">1.5</span>),</span>
<span id="cb70-1199"><a href="#cb70-1199" aria-hidden="true" tabindex="-1"></a>  <span class="at">wool_growth_mm =</span> <span class="fu">rep</span>(<span class="fu">rnorm</span>(<span class="dv">60</span>, <span class="at">mean =</span> <span class="dv">8</span>, <span class="at">sd =</span> <span class="fl">1.5</span>), <span class="at">each =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb70-1200"><a href="#cb70-1200" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">rnorm</span>(<span class="dv">240</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb70-1201"><a href="#cb70-1201" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-1202"><a href="#cb70-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1203"><a href="#cb70-1203" aria-hidden="true" tabindex="-1"></a><span class="co"># Add some additional variables</span></span>
<span id="cb70-1204"><a href="#cb70-1204" aria-hidden="true" tabindex="-1"></a>sheep_data <span class="ot">&lt;-</span> sheep_data <span class="sc">%&gt;%</span></span>
<span id="cb70-1205"><a href="#cb70-1205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sheep_id) <span class="sc">%&gt;%</span></span>
<span id="cb70-1206"><a href="#cb70-1206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb70-1207"><a href="#cb70-1207" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight_gain_kg =</span> weight_kg <span class="sc">-</span> <span class="fu">first</span>(weight_kg),</span>
<span id="cb70-1208"><a href="#cb70-1208" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_daily_gain_g =</span> (weight_gain_kg <span class="sc">*</span> <span class="dv">1000</span>) <span class="sc">/</span> (week <span class="sc">*</span> <span class="dv">7</span>)</span>
<span id="cb70-1209"><a href="#cb70-1209" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb70-1210"><a href="#cb70-1210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb70-1211"><a href="#cb70-1211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(week <span class="sc">&gt;</span> <span class="dv">0</span>)  <span class="co"># Remove week 0 for some analyses</span></span>
<span id="cb70-1212"><a href="#cb70-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1213"><a href="#cb70-1213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1214"><a href="#cb70-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1215"><a href="#cb70-1215" aria-hidden="true" tabindex="-1"></a><span class="fu">### Part 1: Scatter Plot (20 points)</span></span>
<span id="cb70-1216"><a href="#cb70-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1217"><a href="#cb70-1217" aria-hidden="true" tabindex="-1"></a>Create a scatter plot showing the relationship between <span class="in">`weight_kg`</span> (x-axis) and <span class="in">`wool_growth_mm`</span> (y-axis).</span>
<span id="cb70-1218"><a href="#cb70-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1219"><a href="#cb70-1219" aria-hidden="true" tabindex="-1"></a>**Requirements**:</span>
<span id="cb70-1220"><a href="#cb70-1220" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Color points by <span class="in">`breed`</span></span>
<span id="cb70-1221"><a href="#cb70-1221" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Set point size to 3</span>
<span id="cb70-1222"><a href="#cb70-1222" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use <span class="in">`theme_minimal()`</span></span>
<span id="cb70-1223"><a href="#cb70-1223" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Add appropriate title and axis labels</span>
<span id="cb70-1224"><a href="#cb70-1224" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Include a subtitle indicating sample size</span>
<span id="cb70-1225"><a href="#cb70-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1226"><a href="#cb70-1226" aria-hidden="true" tabindex="-1"></a>**Bonus** (+5 points): Add a trend line using <span class="in">`geom_smooth(method = "lm")`</span> for each breed</span>
<span id="cb70-1227"><a href="#cb70-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1228"><a href="#cb70-1228" aria-hidden="true" tabindex="-1"></a><span class="fu">### Part 2: Line Plot (20 points)</span></span>
<span id="cb70-1229"><a href="#cb70-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1230"><a href="#cb70-1230" aria-hidden="true" tabindex="-1"></a>Create a line plot showing <span class="in">`weight_kg`</span> over <span class="in">`week`</span> for individual sheep.</span>
<span id="cb70-1231"><a href="#cb70-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1232"><a href="#cb70-1232" aria-hidden="true" tabindex="-1"></a>**Requirements**:</span>
<span id="cb70-1233"><a href="#cb70-1233" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Show data for **6 randomly selected sheep** (use <span class="in">`filter(sheep_id %in% c(...))`</span>)</span>
<span id="cb70-1234"><a href="#cb70-1234" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Color lines by <span class="in">`breed`</span></span>
<span id="cb70-1235"><a href="#cb70-1235" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Add both lines and points</span>
<span id="cb70-1236"><a href="#cb70-1236" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use <span class="in">`theme_classic()`</span></span>
<span id="cb70-1237"><a href="#cb70-1237" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Proper labels and title</span>
<span id="cb70-1238"><a href="#cb70-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1239"><a href="#cb70-1239" aria-hidden="true" tabindex="-1"></a><span class="fu">### Part 3: Bar Chart (20 points)</span></span>
<span id="cb70-1240"><a href="#cb70-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1241"><a href="#cb70-1241" aria-hidden="true" tabindex="-1"></a>Create a bar chart showing the **average final weight** (week 12) by breed and pasture type.</span>
<span id="cb70-1242"><a href="#cb70-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1243"><a href="#cb70-1243" aria-hidden="true" tabindex="-1"></a>**Requirements**:</span>
<span id="cb70-1244"><a href="#cb70-1244" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Calculate average final weight using <span class="in">`dplyr`</span> first</span>
<span id="cb70-1245"><a href="#cb70-1245" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use <span class="in">`geom_col()`</span> with <span class="in">`position = "dodge"`</span> for grouped bars</span>
<span id="cb70-1246"><a href="#cb70-1246" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fill bars by <span class="in">`pasture_type`</span></span>
<span id="cb70-1247"><a href="#cb70-1247" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Add axis labels including units</span>
<span id="cb70-1248"><a href="#cb70-1248" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use a ColorBrewer palette</span>
<span id="cb70-1249"><a href="#cb70-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1250"><a href="#cb70-1250" aria-hidden="true" tabindex="-1"></a><span class="fu">### Part 4: Histogram (15 points)</span></span>
<span id="cb70-1251"><a href="#cb70-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1252"><a href="#cb70-1252" aria-hidden="true" tabindex="-1"></a>Create histograms showing the distribution of <span class="in">`avg_daily_gain_g`</span> for each breed.</span>
<span id="cb70-1253"><a href="#cb70-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1254"><a href="#cb70-1254" aria-hidden="true" tabindex="-1"></a>**Requirements**:</span>
<span id="cb70-1255"><a href="#cb70-1255" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Three separate histograms (one per breed) — hint: use faceting or create 3 separate plots</span>
<span id="cb70-1256"><a href="#cb70-1256" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Choose appropriate binwidth</span>
<span id="cb70-1257"><a href="#cb70-1257" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fill color should differ by breed</span>
<span id="cb70-1258"><a href="#cb70-1258" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use <span class="in">`theme_bw()`</span></span>
<span id="cb70-1259"><a href="#cb70-1259" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Title should be descriptive</span>
<span id="cb70-1260"><a href="#cb70-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1261"><a href="#cb70-1261" aria-hidden="true" tabindex="-1"></a>**Note**: We'll cover faceting (<span class="in">`facet_wrap()`</span>) in the next chapter, but you can try it now or create 3 separate plots.</span>
<span id="cb70-1262"><a href="#cb70-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1263"><a href="#cb70-1263" aria-hidden="true" tabindex="-1"></a><span class="fu">### Part 5: Box Plot or Violin Plot (20 points)</span></span>
<span id="cb70-1264"><a href="#cb70-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1265"><a href="#cb70-1265" aria-hidden="true" tabindex="-1"></a>Compare the distribution of <span class="in">`weight_gain_kg`</span> (total gain over the study) across breeds and pasture types.</span>
<span id="cb70-1266"><a href="#cb70-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1267"><a href="#cb70-1267" aria-hidden="true" tabindex="-1"></a>**Requirements**:</span>
<span id="cb70-1268"><a href="#cb70-1268" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use <span class="in">`geom_boxplot()`</span> OR <span class="in">`geom_violin()`</span> (your choice)</span>
<span id="cb70-1269"><a href="#cb70-1269" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>X-axis: <span class="in">`breed`</span>, fill by <span class="in">`pasture_type`</span></span>
<span id="cb70-1270"><a href="#cb70-1270" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Add jittered points with transparency</span>
<span id="cb70-1271"><a href="#cb70-1271" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use <span class="in">`theme_light()`</span></span>
<span id="cb70-1272"><a href="#cb70-1272" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Clear labels and legend</span>
<span id="cb70-1273"><a href="#cb70-1273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1274"><a href="#cb70-1274" aria-hidden="true" tabindex="-1"></a><span class="fu">### Part 6: Interpretation (5 points)</span></span>
<span id="cb70-1275"><a href="#cb70-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1276"><a href="#cb70-1276" aria-hidden="true" tabindex="-1"></a>For each plot, write 2-3 sentences interpreting what the plot shows. What patterns, trends, or differences do you observe?</span>
<span id="cb70-1277"><a href="#cb70-1277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1278"><a href="#cb70-1278" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bonus Challenge (+10 points)</span></span>
<span id="cb70-1279"><a href="#cb70-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1280"><a href="#cb70-1280" aria-hidden="true" tabindex="-1"></a>Create a single multi-panel figure combining your scatter plot and box plot using either:</span>
<span id="cb70-1281"><a href="#cb70-1281" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Manual arrangement (creating two separate plots)</span>
<span id="cb70-1282"><a href="#cb70-1282" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Looking ahead: Try <span class="in">`library(patchwork)`</span> and combine with <span class="in">`+`</span></span>
<span id="cb70-1283"><a href="#cb70-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1286"><a href="#cb70-1286" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1287"><a href="#cb70-1287" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb70-1288"><a href="#cb70-1288" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb70-1289"><a href="#cb70-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1290"><a href="#cb70-1290" aria-hidden="true" tabindex="-1"></a><span class="co"># Example structure (you'll learn this next week!)</span></span>
<span id="cb70-1291"><a href="#cb70-1291" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb70-1292"><a href="#cb70-1292" aria-hidden="true" tabindex="-1"></a>plot1 <span class="sc">+</span> plot2</span>
<span id="cb70-1293"><a href="#cb70-1293" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1294"><a href="#cb70-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1295"><a href="#cb70-1295" aria-hidden="true" tabindex="-1"></a><span class="fu">### Submission Requirements</span></span>
<span id="cb70-1296"><a href="#cb70-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1297"><a href="#cb70-1297" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Submit a rendered Quarto HTML document</span>
<span id="cb70-1298"><a href="#cb70-1298" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Include all code and output</span>
<span id="cb70-1299"><a href="#cb70-1299" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>All plots should be clearly labeled</span>
<span id="cb70-1300"><a href="#cb70-1300" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use professional formatting</span>
<span id="cb70-1301"><a href="#cb70-1301" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Include interpretations</span>
<span id="cb70-1302"><a href="#cb70-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1303"><a href="#cb70-1303" aria-hidden="true" tabindex="-1"></a><span class="fu">### Recommended YAML</span></span>
<span id="cb70-1304"><a href="#cb70-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1305"><a href="#cb70-1305" aria-hidden="true" tabindex="-1"></a><span class="in">```yaml</span></span>
<span id="cb70-1306"><a href="#cb70-1306" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb70-1307"><a href="#cb70-1307" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"Week 5 Homework: Data Visualization with ggplot2"</span></span>
<span id="cb70-1308"><a href="#cb70-1308" aria-hidden="true" tabindex="-1"></a><span class="fu">author</span><span class="kw">:</span><span class="at"> </span><span class="st">"Your Name"</span></span>
<span id="cb70-1309"><a href="#cb70-1309" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span><span class="kw">:</span><span class="at"> today</span></span>
<span id="cb70-1310"><a href="#cb70-1310" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span><span class="kw">:</span></span>
<span id="cb70-1311"><a href="#cb70-1311" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">html</span><span class="kw">:</span></span>
<span id="cb70-1312"><a href="#cb70-1312" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb70-1313"><a href="#cb70-1313" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc-depth</span><span class="kw">:</span><span class="at"> </span><span class="dv">2</span></span>
<span id="cb70-1314"><a href="#cb70-1314" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">code-fold</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb70-1315"><a href="#cb70-1315" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">theme</span><span class="kw">:</span><span class="at"> cosmo</span></span>
<span id="cb70-1316"><a href="#cb70-1316" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">embed-resources</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb70-1317"><a href="#cb70-1317" aria-hidden="true" tabindex="-1"></a><span class="fu">execute</span><span class="kw">:</span></span>
<span id="cb70-1318"><a href="#cb70-1318" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">warning</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb70-1319"><a href="#cb70-1319" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">message</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb70-1320"><a href="#cb70-1320" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb70-1321"><a href="#cb70-1321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1322"><a href="#cb70-1322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1323"><a href="#cb70-1323" aria-hidden="true" tabindex="-1"></a><span class="fu">### Grading Rubric</span></span>
<span id="cb70-1324"><a href="#cb70-1324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1325"><a href="#cb70-1325" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Part 1: Scatter Plot (20%)**</span>
<span id="cb70-1326"><a href="#cb70-1326" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Correct geom and aesthetics (8%)</span>
<span id="cb70-1327"><a href="#cb70-1327" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Proper labels and theme (7%)</span>
<span id="cb70-1328"><a href="#cb70-1328" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Overall appearance (5%)</span>
<span id="cb70-1329"><a href="#cb70-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1330"><a href="#cb70-1330" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Part 2: Line Plot (20%)**</span>
<span id="cb70-1331"><a href="#cb70-1331" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Correct data filtering and plotting (8%)</span>
<span id="cb70-1332"><a href="#cb70-1332" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Lines and points shown (7%)</span>
<span id="cb70-1333"><a href="#cb70-1333" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Labels and styling (5%)</span>
<span id="cb70-1334"><a href="#cb70-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1335"><a href="#cb70-1335" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Part 3: Bar Chart (20%)**</span>
<span id="cb70-1336"><a href="#cb70-1336" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Correct data summarization (8%)</span>
<span id="cb70-1337"><a href="#cb70-1337" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Grouped bars correctly displayed (7%)</span>
<span id="cb70-1338"><a href="#cb70-1338" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Labels and color palette (5%)</span>
<span id="cb70-1339"><a href="#cb70-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1340"><a href="#cb70-1340" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Part 4: Histogram (15%)**</span>
<span id="cb70-1341"><a href="#cb70-1341" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Appropriate binwidth chosen (6%)</span>
<span id="cb70-1342"><a href="#cb70-1342" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>One histogram per breed (5%)</span>
<span id="cb70-1343"><a href="#cb70-1343" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Labels and theme (4%)</span>
<span id="cb70-1344"><a href="#cb70-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1345"><a href="#cb70-1345" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Part 5: Box/Violin Plot (20%)**</span>
<span id="cb70-1346"><a href="#cb70-1346" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Correct plot with multiple groupings (8%)</span>
<span id="cb70-1347"><a href="#cb70-1347" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Points added with transparency (7%)</span>
<span id="cb70-1348"><a href="#cb70-1348" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Labels and theme (5%)</span>
<span id="cb70-1349"><a href="#cb70-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1350"><a href="#cb70-1350" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Part 6: Interpretation (5%)**</span>
<span id="cb70-1351"><a href="#cb70-1351" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Clear, accurate interpretations for each plot</span>
<span id="cb70-1352"><a href="#cb70-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1353"><a href="#cb70-1353" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb70-1354"><a href="#cb70-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1355"><a href="#cb70-1355" aria-hidden="true" tabindex="-1"></a><span class="fu">## Additional Resources</span></span>
<span id="cb70-1356"><a href="#cb70-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1357"><a href="#cb70-1357" aria-hidden="true" tabindex="-1"></a><span class="fu">### Required Reading</span></span>
<span id="cb70-1358"><a href="#cb70-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1359"><a href="#cb70-1359" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">R for Data Science (2e)</span><span class="co">](https://r4ds.hadley.nz/)</span> - Chapters 9-10: Visualize and Layers</span>
<span id="cb70-1360"><a href="#cb70-1360" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">ggplot2 documentation</span><span class="co">](https://ggplot2.tidyverse.org/)</span></span>
<span id="cb70-1361"><a href="#cb70-1361" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">ggplot2 book (3e)</span><span class="co">](https://ggplot2-book.org/)</span> - Chapters 1-4</span>
<span id="cb70-1362"><a href="#cb70-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1363"><a href="#cb70-1363" aria-hidden="true" tabindex="-1"></a><span class="fu">### Optional Reading</span></span>
<span id="cb70-1364"><a href="#cb70-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1365"><a href="#cb70-1365" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Wilkinson, L. (2005). *The Grammar of Graphics* (2nd ed.). Springer. (Original theory)</span>
<span id="cb70-1366"><a href="#cb70-1366" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Wickham, H. (2010). "A Layered Grammar of Graphics." *Journal of Computational and Graphical Statistics*, 19(1), 3-28.</span>
<span id="cb70-1367"><a href="#cb70-1367" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Data Visualization: A Practical Introduction</span><span class="co">](https://socviz.co/)</span> by Kieran Healy</span>
<span id="cb70-1368"><a href="#cb70-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1369"><a href="#cb70-1369" aria-hidden="true" tabindex="-1"></a><span class="fu">### Videos</span></span>
<span id="cb70-1370"><a href="#cb70-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1371"><a href="#cb70-1371" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>"ggplot2 Workshop" by Thomas Lin Pedersen (RStudio)</span>
<span id="cb70-1372"><a href="#cb70-1372" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>"A Quick Introduction to ggplot2" by StatQuest with Josh Starmer</span>
<span id="cb70-1373"><a href="#cb70-1373" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>"ggplot2 Tutorial" series by Data Science Dojo</span>
<span id="cb70-1374"><a href="#cb70-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1375"><a href="#cb70-1375" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cheat Sheets</span></span>
<span id="cb70-1376"><a href="#cb70-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1377"><a href="#cb70-1377" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">ggplot2 Cheat Sheet</span><span class="co">](https://rstudio.github.io/cheatsheets/data-visualization.pdf)</span> ⭐ **Most important!**</span>
<span id="cb70-1378"><a href="#cb70-1378" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">RStudio Cheatsheets Collection</span><span class="co">](https://posit.co/resources/cheatsheets/)</span></span>
<span id="cb70-1379"><a href="#cb70-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1380"><a href="#cb70-1380" aria-hidden="true" tabindex="-1"></a><span class="fu">### Galleries and Inspiration</span></span>
<span id="cb70-1381"><a href="#cb70-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1382"><a href="#cb70-1382" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">R Graph Gallery</span><span class="co">](https://r-graph-gallery.com/)</span> — Hundreds of examples with code</span>
<span id="cb70-1383"><a href="#cb70-1383" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Top 50 ggplot2 Visualizations</span><span class="co">](http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html)</span></span>
<span id="cb70-1384"><a href="#cb70-1384" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">ggplot2 extensions</span><span class="co">](https://exts.ggplot2.tidyverse.org/)</span> — Additional packages</span>
<span id="cb70-1385"><a href="#cb70-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1386"><a href="#cb70-1386" aria-hidden="true" tabindex="-1"></a><span class="fu">### Color Resources</span></span>
<span id="cb70-1387"><a href="#cb70-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1388"><a href="#cb70-1388" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">ColorBrewer</span><span class="co">](https://colorbrewer2.org/)</span> — Color schemes for maps and data viz</span>
<span id="cb70-1389"><a href="#cb70-1389" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Viridis color palettes</span><span class="co">](https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html)</span> — Colorblind-friendly</span>
<span id="cb70-1390"><a href="#cb70-1390" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Coolors</span><span class="co">](https://coolors.co/)</span> — Color palette generator</span>
<span id="cb70-1391"><a href="#cb70-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1392"><a href="#cb70-1392" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interactive Learning</span></span>
<span id="cb70-1393"><a href="#cb70-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1394"><a href="#cb70-1394" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">RStudio Primers: Visualize Data</span><span class="co">](https://posit.cloud/learn/primers/3)</span></span>
<span id="cb70-1395"><a href="#cb70-1395" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">ggplot2 Exercises</span><span class="co">](https://r-graphics.org/exercises.html)</span></span>
<span id="cb70-1396"><a href="#cb70-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1397"><a href="#cb70-1397" aria-hidden="true" tabindex="-1"></a><span class="fu">### Useful Websites</span></span>
<span id="cb70-1398"><a href="#cb70-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1399"><a href="#cb70-1399" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">ggplot2 Tidyverse Page</span><span class="co">](https://ggplot2.tidyverse.org/)</span></span>
<span id="cb70-1400"><a href="#cb70-1400" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Stack Overflow: ggplot2 tag</span><span class="co">](https://stackoverflow.com/questions/tagged/ggplot2)</span></span>
<span id="cb70-1401"><a href="#cb70-1401" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">RStudio Community</span><span class="co">](https://community.rstudio.com/)</span></span>
<span id="cb70-1402"><a href="#cb70-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1403"><a href="#cb70-1403" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb70-1404"><a href="#cb70-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1405"><a href="#cb70-1405" aria-hidden="true" tabindex="-1"></a>**Next Chapter**: <span class="co">[</span><span class="ot">Advanced ggplot2 and Multi-Panel Plots</span><span class="co">](ch06-ggplot2_advanced.qmd)</span></span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>